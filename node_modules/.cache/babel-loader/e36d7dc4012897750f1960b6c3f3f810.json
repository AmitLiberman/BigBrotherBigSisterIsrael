{"ast":null,"code":"var _jsxFileName = \"/Users/wadie/BigBrotherBigSisterIsrael/src/navBarComponents/homeComponents/HomePage.jsx\";\nimport * as React from \"react\";\nimport \"./HomePage.css\";\nimport firebase from \"../../config/Firebase\";\nimport AddPicture from \"../wallComponents/wall/AddPicture\";\nimport NewsList from \"./NewsList\";\nimport logo from '../../static_pictures/no_profile_picture.png';\nexport class HomePage extends React.Component {\n  constructor(props) {\n    super(props);\n\n    this.formatDate = date => {\n      // formatting date to [DD/MM/YYYY]\n      if (date === \"\") {\n        return \"\";\n      }\n\n      return `${date.getDate()}/${date.getMonth() + 1}/${date.getFullYear()}`;\n    };\n\n    this.callbackForm = formData => {\n      this.setState({\n        showPicForm: formData\n      });\n    };\n\n    this.connectToVideo = hosting => {\n      // connect to video directly from home page\n      this.setState({\n        vidButtonHide: true\n      });\n      this.props.directVid(hosting);\n    };\n\n    this.setVideoButton = () => {\n      // determine the appearance of join video button\n      if (this.props.newVideo === \"added\") this.setState({\n        vidButtonHide: false\n      });else if (this.props.newVideo === \"removed\") this.setState({\n        vidButtonHide: true\n      });\n    };\n\n    this.getNewPostAlert = () => {\n      var postsRef;\n      var linkUser;\n      this.usersRef.doc(this.userUid).get().then(doc => {\n        if (doc.data().type === 'חונך') postsRef = doc.ref.collection('Posts');else if (doc.data().type === 'חניך') postsRef = this.usersRef.doc(doc.data().link_user).collection('Posts');\n        linkUser = doc.data().link_user;\n      }).then(() => {\n        postsRef.where('uploader', '==', linkUser).where('unread', '==', true).get().then(docs => this.setState({\n          newPosts: docs.docs.length\n        }));\n      }).catch(e => console.log(e.name));\n    };\n\n    this.uploadProfilePicture = () => {\n      this.setState({\n        showPicForm: true\n      });\n    };\n\n    this.deleteProfilePicture = () => {\n      var con = window.confirm(\"האם אתה בטוח שברצונך להסיר את תמונת הפרופיל הנוכחית שלך?\");\n      if (!con) return;\n      this.myProfilePicturesRef.delete().then(() => {\n        console.log(\"Deleted profile picture successfully\");\n        this.props.changeProfilePictue(\"\");\n      }).catch(e => console.log(e.name));\n    };\n\n    this.setProfilePicture = (pictures, url) => {\n      this.props.changeProfilePictue(url);\n      this.myProfilePicturesRef.put(pictures[0]);\n    };\n\n    this.state = {\n      roomId: \"\",\n      vidButtonHide: true,\n      profilePicture: \"\",\n      showPicForm: false,\n      newPosts: 0\n    };\n    this.userUid = firebase.auth().currentUser.uid;\n    this.usersRef = firebase.firestore().collection('Users');\n    this.cloudRef = firebase.storage().ref();\n    this.myProfilePicturesRef = this.cloudRef.child('profile_pictures/' + firebase.auth().currentUser.uid);\n  }\n\n  componentDidMount() {\n    this.setVideoButton();\n    this.props.getNextMeeting();\n    this.setState({\n      profilePicture: this.props.myProfilePic\n    });\n    this.getNewPostAlert();\n  }\n\n  componentDidUpdate(prevProp) {\n    if (this.props.newVideo !== prevProp.newVideo) this.setVideoButton();else if (this.props.myProfilePic !== prevProp.myProfilePic) this.setState({\n      profilePicture: this.props.myProfilePic\n    });\n  }\n\n  render() {\n    return /*#__PURE__*/React.createElement(\"div\", {\n      className: \"page\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 108,\n        columnNumber: 7\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"homepage-main\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 109,\n        columnNumber: 9\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"homepage-background-right\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 110,\n        columnNumber: 11\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"homepage-right\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 111,\n        columnNumber: 13\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"homepage-profile-top\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 112,\n        columnNumber: 15\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"homepage-profile-name\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 113,\n        columnNumber: 17\n      }\n    }, this.props.myDetails.fName + \" \" + this.props.myDetails.lName), /*#__PURE__*/React.createElement(\"img\", {\n      src: this.state.profilePicture,\n      alt: \"\",\n      className: \"homepage-profile-picture\",\n      style: {\n        backgroundImage: `url(${logo})`\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 116,\n        columnNumber: 17\n      }\n    })), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"homepage-profile-footer\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 118,\n        columnNumber: 15\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"homepage-profile-type-m-s\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 119,\n        columnNumber: 17\n      }\n    }, this.props.myDetails.type), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"homepage-profile-city\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 122,\n        columnNumber: 17\n      }\n    }, this.props.myDetails.area), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"homepage-profile-birthday\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 125,\n        columnNumber: 17\n      }\n    }, this.formatDate(new Date(this.props.myDetails.birthDate)))))), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"homepage-background-left\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 131,\n        columnNumber: 11\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"homepage-left\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 132,\n        columnNumber: 13\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"homepage-profile-top\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 133,\n        columnNumber: 15\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"homepage-profile-name\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 134,\n        columnNumber: 17\n      }\n    }, this.props.linkedDetails.fName + \" \" + this.props.linkedDetails.lName), /*#__PURE__*/React.createElement(\"img\", {\n      src: this.props.friendProfilePic,\n      alt: \"\",\n      className: \"homepage-profile-picture\",\n      style: {\n        backgroundImage: `url(${logo})`\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 137,\n        columnNumber: 17\n      }\n    })), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"homepage-profile-footer\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 139,\n        columnNumber: 15\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"homepage-profile-type-m-s\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 140,\n        columnNumber: 17\n      }\n    }, this.props.linkedDetails.type), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"homepage-profile-city\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 143,\n        columnNumber: 17\n      }\n    }, this.props.linkedDetails.area), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"homepage-profile-birthday\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 146,\n        columnNumber: 17\n      }\n    }, this.formatDate(new Date(this.props.linkedDetails.birthDate))))))), /*#__PURE__*/React.createElement(\"button\", {\n      className: \"btn btn-success profile-upload-btn\",\n      onClick: this.uploadProfilePicture,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 153,\n        columnNumber: 9\n      }\n    }, \"\\u05E9\\u05E0\\u05D4 \\u05EA\\u05DE\\u05D5\\u05E0\\u05EA \\u05E4\\u05E8\\u05D5\\u05E4\\u05D9\\u05DC\"), /*#__PURE__*/React.createElement(\"button\", {\n      className: \"btn btn-danger profile-delete-btn\",\n      onClick: this.deleteProfilePicture,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 154,\n        columnNumber: 9\n      }\n    }, \"\\u05D4\\u05E1\\u05E8 \\u05EA\\u05DE\\u05D5\\u05E0\\u05EA \\u05E4\\u05E8\\u05D5\\u05E4\\u05D9\\u05DC\"), /*#__PURE__*/React.createElement(NewsList, {\n      linked_name: this.props.linkedDetails.fName,\n      connectToVideo: this.connectToVideo,\n      vidButtonHide: this.state.vidButtonHide,\n      otherUserConnection: this.props.otherUserConnection,\n      otherUserLastOnline: this.props.otherUserLastOnline,\n      next_meeting: this.props.next_meeting,\n      loadingNextMeeting: this.props.loadingNextMeeting,\n      routeToWall: this.props.routeToWall,\n      routeToMeeting: this.props.routeToMeeting,\n      newPosts: this.state.newPosts,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 155,\n        columnNumber: 9\n      }\n    }), this.state.showPicForm ? /*#__PURE__*/React.createElement(AddPicture, {\n      parentCallback: this.callbackForm,\n      showText: false,\n      setImagePostParent: this.setProfilePicture,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 169,\n        columnNumber: 11\n      }\n    }) : null);\n  }\n\n}\nexport default HomePage;","map":{"version":3,"sources":["/Users/wadie/BigBrotherBigSisterIsrael/src/navBarComponents/homeComponents/HomePage.jsx"],"names":["React","firebase","AddPicture","NewsList","logo","HomePage","Component","constructor","props","formatDate","date","getDate","getMonth","getFullYear","callbackForm","formData","setState","showPicForm","connectToVideo","hosting","vidButtonHide","directVid","setVideoButton","newVideo","getNewPostAlert","postsRef","linkUser","usersRef","doc","userUid","get","then","data","type","ref","collection","link_user","where","docs","newPosts","length","catch","e","console","log","name","uploadProfilePicture","deleteProfilePicture","con","window","confirm","myProfilePicturesRef","delete","changeProfilePictue","setProfilePicture","pictures","url","put","state","roomId","profilePicture","auth","currentUser","uid","firestore","cloudRef","storage","child","componentDidMount","getNextMeeting","myProfilePic","componentDidUpdate","prevProp","render","myDetails","fName","lName","backgroundImage","area","Date","birthDate","linkedDetails","friendProfilePic","otherUserConnection","otherUserLastOnline","next_meeting","loadingNextMeeting","routeToWall","routeToMeeting"],"mappings":";AAAA,OAAO,KAAKA,KAAZ,MAAuB,OAAvB;AACA,OAAO,gBAAP;AACA,OAAOC,QAAP,MAAqB,uBAArB;AACA,OAAOC,UAAP,MAAuB,mCAAvB;AACA,OAAOC,QAAP,MAAqB,YAArB;AACA,OAAOC,IAAP,MAAiB,8CAAjB;AAEA,OAAO,MAAMC,QAAN,SAAuBL,KAAK,CAACM,SAA7B,CAAuC;AAC5CC,EAAAA,WAAW,CAACC,KAAD,EAAQ;AACjB,UAAMA,KAAN;;AADiB,SAenBC,UAfmB,GAeLC,IAAD,IAAU;AAAE;AACvB,UAAIA,IAAI,KAAK,EAAb,EAAiB;AACf,eAAO,EAAP;AACD;;AACD,aAAQ,GAAEA,IAAI,CAACC,OAAL,EAAe,IAAGD,IAAI,CAACE,QAAL,KAAkB,CAAE,IAAGF,IAAI,CAACG,WAAL,EAAmB,EAAtE;AACD,KApBkB;;AAAA,SAsBnBC,YAtBmB,GAsBHC,QAAD,IAAc;AAC3B,WAAKC,QAAL,CAAc;AAAEC,QAAAA,WAAW,EAAEF;AAAf,OAAd;AACD,KAxBkB;;AAAA,SA0BnBG,cA1BmB,GA0BDC,OAAD,IAAa;AAAE;AAC9B,WAAKH,QAAL,CAAc;AAAEI,QAAAA,aAAa,EAAE;AAAjB,OAAd;AACA,WAAKZ,KAAL,CAAWa,SAAX,CAAqBF,OAArB;AACD,KA7BkB;;AAAA,SA+BnBG,cA/BmB,GA+BF,MAAM;AAAE;AACvB,UAAI,KAAKd,KAAL,CAAWe,QAAX,KAAwB,OAA5B,EACE,KAAKP,QAAL,CAAc;AAAEI,QAAAA,aAAa,EAAE;AAAjB,OAAd,EADF,KAEK,IAAI,KAAKZ,KAAL,CAAWe,QAAX,KAAwB,SAA5B,EACH,KAAKP,QAAL,CAAc;AAAEI,QAAAA,aAAa,EAAE;AAAjB,OAAd;AACH,KApCkB;;AAAA,SAsCnBI,eAtCmB,GAsCD,MAAM;AACtB,UAAIC,QAAJ;AACA,UAAIC,QAAJ;AACA,WAAKC,QAAL,CAAcC,GAAd,CAAkB,KAAKC,OAAvB,EAAgCC,GAAhC,GACGC,IADH,CACQH,GAAG,IAAI;AACX,YAAIA,GAAG,CAACI,IAAJ,GAAWC,IAAX,KAAoB,MAAxB,EACER,QAAQ,GAAGG,GAAG,CAACM,GAAJ,CAAQC,UAAR,CAAmB,OAAnB,CAAX,CADF,KAEK,IAAIP,GAAG,CAACI,IAAJ,GAAWC,IAAX,KAAoB,MAAxB,EACHR,QAAQ,GAAG,KAAKE,QAAL,CAAcC,GAAd,CAAkBA,GAAG,CAACI,IAAJ,GAAWI,SAA7B,EAAwCD,UAAxC,CAAmD,OAAnD,CAAX;AACFT,QAAAA,QAAQ,GAAGE,GAAG,CAACI,IAAJ,GAAWI,SAAtB;AACD,OAPH,EAQGL,IARH,CAQQ,MAAM;AACVN,QAAAA,QAAQ,CACLY,KADH,CACS,UADT,EACqB,IADrB,EAC2BX,QAD3B,EAEGW,KAFH,CAES,QAFT,EAEmB,IAFnB,EAEyB,IAFzB,EAGGP,GAHH,GAIGC,IAJH,CAISO,IAAD,IACJ,KAAKtB,QAAL,CAAc;AAAEuB,UAAAA,QAAQ,EAAED,IAAI,CAACA,IAAL,CAAUE;AAAtB,SAAd,CALJ;AAMD,OAfH,EAgBGC,KAhBH,CAgBUC,CAAD,IAAOC,OAAO,CAACC,GAAR,CAAYF,CAAC,CAACG,IAAd,CAhBhB;AAiBD,KA1DkB;;AAAA,SA0EnBC,oBA1EmB,GA0EI,MAAM;AAC3B,WAAK9B,QAAL,CAAc;AACZC,QAAAA,WAAW,EAAE;AADD,OAAd;AAGD,KA9EkB;;AAAA,SAgFnB8B,oBAhFmB,GAgFI,MAAM;AAC3B,UAAIC,GAAG,GAAGC,MAAM,CAACC,OAAP,CAAe,0DAAf,CAAV;AACA,UAAI,CAACF,GAAL,EACE;AACF,WAAKG,oBAAL,CAA0BC,MAA1B,GACGrB,IADH,CACQ,MAAM;AACVY,QAAAA,OAAO,CAACC,GAAR,CAAY,sCAAZ;AACA,aAAKpC,KAAL,CAAW6C,mBAAX,CAA+B,EAA/B;AACD,OAJH,EAKGZ,KALH,CAKUC,CAAD,IAAOC,OAAO,CAACC,GAAR,CAAYF,CAAC,CAACG,IAAd,CALhB;AAMD,KA1FkB;;AAAA,SA4FnBS,iBA5FmB,GA4FC,CAACC,QAAD,EAAWC,GAAX,KAAmB;AACrC,WAAKhD,KAAL,CAAW6C,mBAAX,CAA+BG,GAA/B;AACA,WAAKL,oBAAL,CAA0BM,GAA1B,CAA8BF,QAAQ,CAAC,CAAD,CAAtC;AACD,KA/FkB;;AAEjB,SAAKG,KAAL,GAAa;AACXC,MAAAA,MAAM,EAAE,EADG;AAEXvC,MAAAA,aAAa,EAAE,IAFJ;AAGXwC,MAAAA,cAAc,EAAE,EAHL;AAIX3C,MAAAA,WAAW,EAAE,KAJF;AAKXsB,MAAAA,QAAQ,EAAE;AALC,KAAb;AAOA,SAAKV,OAAL,GAAe5B,QAAQ,CAAC4D,IAAT,GAAgBC,WAAhB,CAA4BC,GAA3C;AACA,SAAKpC,QAAL,GAAgB1B,QAAQ,CAAC+D,SAAT,GAAqB7B,UAArB,CAAgC,OAAhC,CAAhB;AACA,SAAK8B,QAAL,GAAgBhE,QAAQ,CAACiE,OAAT,GAAmBhC,GAAnB,EAAhB;AACA,SAAKiB,oBAAL,GAA4B,KAAKc,QAAL,CAAcE,KAAd,CAAoB,sBAAsBlE,QAAQ,CAAC4D,IAAT,GAAgBC,WAAhB,CAA4BC,GAAtE,CAA5B;AACD;;AA+CDK,EAAAA,iBAAiB,GAAG;AAClB,SAAK9C,cAAL;AACA,SAAKd,KAAL,CAAW6D,cAAX;AACA,SAAKrD,QAAL,CAAc;AAAE4C,MAAAA,cAAc,EAAE,KAAKpD,KAAL,CAAW8D;AAA7B,KAAd;AACA,SAAK9C,eAAL;AACD;;AAED+C,EAAAA,kBAAkB,CAACC,QAAD,EAAW;AAC3B,QAAI,KAAKhE,KAAL,CAAWe,QAAX,KAAwBiD,QAAQ,CAACjD,QAArC,EACE,KAAKD,cAAL,GADF,KAEK,IAAI,KAAKd,KAAL,CAAW8D,YAAX,KAA4BE,QAAQ,CAACF,YAAzC,EACH,KAAKtD,QAAL,CAAc;AAAE4C,MAAAA,cAAc,EAAE,KAAKpD,KAAL,CAAW8D;AAA7B,KAAd;AACH;;AAyBDG,EAAAA,MAAM,GAAG;AACP,wBACE;AAAK,MAAA,SAAS,EAAC,MAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBACE;AAAK,MAAA,SAAS,EAAC,eAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBACE;AAAK,MAAA,SAAS,EAAC,2BAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBACE;AAAK,MAAA,SAAS,EAAC,gBAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBACE;AAAK,MAAA,SAAS,EAAC,sBAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBACE;AAAK,MAAA,SAAS,EAAC,uBAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OACG,KAAKjE,KAAL,CAAWkE,SAAX,CAAqBC,KAArB,GAA6B,GAA7B,GAAmC,KAAKnE,KAAL,CAAWkE,SAAX,CAAqBE,KAD3D,CADF,eAIE;AAAK,MAAA,GAAG,EAAE,KAAKlB,KAAL,CAAWE,cAArB;AAAqC,MAAA,GAAG,EAAC,EAAzC;AAA4C,MAAA,SAAS,EAAC,0BAAtD;AAAiF,MAAA,KAAK,EAAE;AAAEiB,QAAAA,eAAe,EAAG,OAAMzE,IAAK;AAA/B,OAAxF;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MAJF,CADF,eAOE;AAAK,MAAA,SAAS,EAAC,yBAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBACE;AAAK,MAAA,SAAS,EAAC,2BAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OACG,KAAKI,KAAL,CAAWkE,SAAX,CAAqBzC,IADxB,CADF,eAIE;AAAK,MAAA,SAAS,EAAC,uBAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OACG,KAAKzB,KAAL,CAAWkE,SAAX,CAAqBI,IADxB,CAJF,eAOE;AAAK,MAAA,SAAS,EAAC,2BAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OACG,KAAKrE,UAAL,CAAgB,IAAIsE,IAAJ,CAAS,KAAKvE,KAAL,CAAWkE,SAAX,CAAqBM,SAA9B,CAAhB,CADH,CAPF,CAPF,CADF,CADF,eAsBE;AAAK,MAAA,SAAS,EAAC,0BAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBACE;AAAK,MAAA,SAAS,EAAC,eAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBACE;AAAK,MAAA,SAAS,EAAC,sBAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBACE;AAAK,MAAA,SAAS,EAAC,uBAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OACG,KAAKxE,KAAL,CAAWyE,aAAX,CAAyBN,KAAzB,GAAiC,GAAjC,GAAuC,KAAKnE,KAAL,CAAWyE,aAAX,CAAyBL,KADnE,CADF,eAIE;AAAK,MAAA,GAAG,EAAE,KAAKpE,KAAL,CAAW0E,gBAArB;AAAuC,MAAA,GAAG,EAAC,EAA3C;AAA8C,MAAA,SAAS,EAAC,0BAAxD;AAAmF,MAAA,KAAK,EAAE;AAAEL,QAAAA,eAAe,EAAG,OAAMzE,IAAK;AAA/B,OAA1F;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MAJF,CADF,eAOE;AAAK,MAAA,SAAS,EAAC,yBAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBACE;AAAK,MAAA,SAAS,EAAC,2BAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OACG,KAAKI,KAAL,CAAWyE,aAAX,CAAyBhD,IAD5B,CADF,eAIE;AAAK,MAAA,SAAS,EAAC,uBAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OACG,KAAKzB,KAAL,CAAWyE,aAAX,CAAyBH,IAD5B,CAJF,eAOE;AAAK,MAAA,SAAS,EAAC,2BAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OACG,KAAKrE,UAAL,CAAgB,IAAIsE,IAAJ,CAAS,KAAKvE,KAAL,CAAWyE,aAAX,CAAyBD,SAAlC,CAAhB,CADH,CAPF,CAPF,CADF,CAtBF,CADF,eA6CE;AAAQ,MAAA,SAAS,EAAC,oCAAlB;AAAuD,MAAA,OAAO,EAAE,KAAKlC,oBAArE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,gGA7CF,eA8CE;AAAQ,MAAA,SAAS,EAAC,mCAAlB;AAAsD,MAAA,OAAO,EAAE,KAAKC,oBAApE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,gGA9CF,eA+CE,oBAAC,QAAD;AACE,MAAA,WAAW,EAAE,KAAKvC,KAAL,CAAWyE,aAAX,CAAyBN,KADxC;AAEE,MAAA,cAAc,EAAE,KAAKzD,cAFvB;AAGE,MAAA,aAAa,EAAE,KAAKwC,KAAL,CAAWtC,aAH5B;AAIE,MAAA,mBAAmB,EAAE,KAAKZ,KAAL,CAAW2E,mBAJlC;AAKE,MAAA,mBAAmB,EAAE,KAAK3E,KAAL,CAAW4E,mBALlC;AAME,MAAA,YAAY,EAAE,KAAK5E,KAAL,CAAW6E,YAN3B;AAOE,MAAA,kBAAkB,EAAE,KAAK7E,KAAL,CAAW8E,kBAPjC;AAQE,MAAA,WAAW,EAAE,KAAK9E,KAAL,CAAW+E,WAR1B;AASE,MAAA,cAAc,EAAE,KAAK/E,KAAL,CAAWgF,cAT7B;AAUE,MAAA,QAAQ,EAAE,KAAK9B,KAAL,CAAWnB,QAVvB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MA/CF,EA4DG,KAAKmB,KAAL,CAAWzC,WAAX,gBACC,oBAAC,UAAD;AACE,MAAA,cAAc,EAAE,KAAKH,YADvB;AAEE,MAAA,QAAQ,EAAE,KAFZ;AAGE,MAAA,kBAAkB,EAAE,KAAKwC,iBAH3B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MADD,GAMG,IAlEN,CADF;AAsED;;AAzK2C;AA4K9C,eAAejD,QAAf","sourcesContent":["import * as React from \"react\";\r\nimport \"./HomePage.css\";\r\nimport firebase from \"../../config/Firebase\"\r\nimport AddPicture from \"../wallComponents/wall/AddPicture\"\r\nimport NewsList from \"./NewsList\"\r\nimport logo from '../../static_pictures/no_profile_picture.png'\r\n\r\nexport class HomePage extends React.Component {\r\n  constructor(props) {\r\n    super(props);\r\n    this.state = {\r\n      roomId: \"\",\r\n      vidButtonHide: true,\r\n      profilePicture: \"\",\r\n      showPicForm: false,\r\n      newPosts: 0\r\n    };\r\n    this.userUid = firebase.auth().currentUser.uid;\r\n    this.usersRef = firebase.firestore().collection('Users');\r\n    this.cloudRef = firebase.storage().ref();\r\n    this.myProfilePicturesRef = this.cloudRef.child('profile_pictures/' + firebase.auth().currentUser.uid);\r\n  }\r\n\r\n  formatDate = (date) => { // formatting date to [DD/MM/YYYY]\r\n    if (date === \"\") {\r\n      return \"\";\r\n    }\r\n    return `${date.getDate()}/${date.getMonth() + 1}/${date.getFullYear()}`\r\n  }\r\n\r\n  callbackForm = (formData) => {\r\n    this.setState({ showPicForm: formData });\r\n  };\r\n\r\n  connectToVideo = (hosting) => { // connect to video directly from home page\r\n    this.setState({ vidButtonHide: true });\r\n    this.props.directVid(hosting);\r\n  }\r\n\r\n  setVideoButton = () => { // determine the appearance of join video button\r\n    if (this.props.newVideo === \"added\")\r\n      this.setState({ vidButtonHide: false });\r\n    else if (this.props.newVideo === \"removed\")\r\n      this.setState({ vidButtonHide: true });\r\n  }\r\n\r\n  getNewPostAlert = () => {\r\n    var postsRef;\r\n    var linkUser;\r\n    this.usersRef.doc(this.userUid).get()\r\n      .then(doc => {\r\n        if (doc.data().type === 'חונך')\r\n          postsRef = doc.ref.collection('Posts');\r\n        else if (doc.data().type === 'חניך')\r\n          postsRef = this.usersRef.doc(doc.data().link_user).collection('Posts');\r\n        linkUser = doc.data().link_user;\r\n      })\r\n      .then(() => {\r\n        postsRef\r\n          .where('uploader', '==', linkUser)\r\n          .where('unread', '==', true)\r\n          .get()\r\n          .then((docs) =>\r\n            this.setState({ newPosts: docs.docs.length }));\r\n      })\r\n      .catch((e) => console.log(e.name));\r\n  }\r\n\r\n  componentDidMount() {\r\n    this.setVideoButton();\r\n    this.props.getNextMeeting();\r\n    this.setState({ profilePicture: this.props.myProfilePic });\r\n    this.getNewPostAlert();\r\n  }\r\n\r\n  componentDidUpdate(prevProp) {\r\n    if (this.props.newVideo !== prevProp.newVideo)\r\n      this.setVideoButton();\r\n    else if (this.props.myProfilePic !== prevProp.myProfilePic)\r\n      this.setState({ profilePicture: this.props.myProfilePic });\r\n  }\r\n\r\n  uploadProfilePicture = () => {\r\n    this.setState({\r\n      showPicForm: true,\r\n    });\r\n  }\r\n\r\n  deleteProfilePicture = () => {\r\n    var con = window.confirm(\"האם אתה בטוח שברצונך להסיר את תמונת הפרופיל הנוכחית שלך?\");\r\n    if (!con)\r\n      return;\r\n    this.myProfilePicturesRef.delete()\r\n      .then(() => {\r\n        console.log(\"Deleted profile picture successfully\")\r\n        this.props.changeProfilePictue(\"\")\r\n      })\r\n      .catch((e) => console.log(e.name));\r\n  }\r\n\r\n  setProfilePicture = (pictures, url) => {\r\n    this.props.changeProfilePictue(url);\r\n    this.myProfilePicturesRef.put(pictures[0]);\r\n  };\r\n\r\n  render() {\r\n    return (\r\n      <div className=\"page\">\r\n        <div className=\"homepage-main\">\r\n          <div className=\"homepage-background-right\">\r\n            <div className=\"homepage-right\">\r\n              <div className=\"homepage-profile-top\">\r\n                <div className=\"homepage-profile-name\">\r\n                  {this.props.myDetails.fName + \" \" + this.props.myDetails.lName}\r\n                </div>\r\n                <img src={this.state.profilePicture} alt=\"\" className=\"homepage-profile-picture\" style={{ backgroundImage: `url(${logo})` }} />\r\n              </div>\r\n              <div className=\"homepage-profile-footer\">\r\n                <div className=\"homepage-profile-type-m-s\">\r\n                  {this.props.myDetails.type}\r\n                </div>\r\n                <div className=\"homepage-profile-city\">\r\n                  {this.props.myDetails.area}\r\n                </div>\r\n                <div className=\"homepage-profile-birthday\">\r\n                  {this.formatDate(new Date(this.props.myDetails.birthDate))}\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n          <div className=\"homepage-background-left\">\r\n            <div className=\"homepage-left\">\r\n              <div className=\"homepage-profile-top\">\r\n                <div className=\"homepage-profile-name\">\r\n                  {this.props.linkedDetails.fName + \" \" + this.props.linkedDetails.lName}\r\n                </div>\r\n                <img src={this.props.friendProfilePic} alt=\"\" className=\"homepage-profile-picture\" style={{ backgroundImage: `url(${logo})` }} />\r\n              </div>\r\n              <div className=\"homepage-profile-footer\">\r\n                <div className=\"homepage-profile-type-m-s\">\r\n                  {this.props.linkedDetails.type}\r\n                </div>\r\n                <div className=\"homepage-profile-city\">\r\n                  {this.props.linkedDetails.area}\r\n                </div>\r\n                <div className=\"homepage-profile-birthday\">\r\n                  {this.formatDate(new Date(this.props.linkedDetails.birthDate))}\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n        <button className=\"btn btn-success profile-upload-btn\" onClick={this.uploadProfilePicture}>שנה תמונת פרופיל</button>\r\n        <button className=\"btn btn-danger profile-delete-btn\" onClick={this.deleteProfilePicture}>הסר תמונת פרופיל</button>\r\n        <NewsList\r\n          linked_name={this.props.linkedDetails.fName}\r\n          connectToVideo={this.connectToVideo}\r\n          vidButtonHide={this.state.vidButtonHide}\r\n          otherUserConnection={this.props.otherUserConnection}\r\n          otherUserLastOnline={this.props.otherUserLastOnline}\r\n          next_meeting={this.props.next_meeting}\r\n          loadingNextMeeting={this.props.loadingNextMeeting}\r\n          routeToWall={this.props.routeToWall}\r\n          routeToMeeting={this.props.routeToMeeting}\r\n          newPosts={this.state.newPosts}\r\n        />\r\n\r\n        {this.state.showPicForm ? (\r\n          <AddPicture\r\n            parentCallback={this.callbackForm}\r\n            showText={false}\r\n            setImagePostParent={this.setProfilePicture}\r\n          />\r\n        ) : null}\r\n      </div>\r\n    );\r\n  }\r\n}\r\n\r\nexport default HomePage;"]},"metadata":{},"sourceType":"module"}