{"ast":null,"code":"import _classCallCheck from\"C:\\\\Users\\\\ahmad\\\\Downloads\\\\BigBrotherBigSisterIsrael-master\\\\BigBrotherBigSisterIsrael-master\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/classCallCheck\";import _createClass from\"C:\\\\Users\\\\ahmad\\\\Downloads\\\\BigBrotherBigSisterIsrael-master\\\\BigBrotherBigSisterIsrael-master\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/createClass\";import _inherits from\"C:\\\\Users\\\\ahmad\\\\Downloads\\\\BigBrotherBigSisterIsrael-master\\\\BigBrotherBigSisterIsrael-master\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/inherits\";import _createSuper from\"C:\\\\Users\\\\ahmad\\\\Downloads\\\\BigBrotherBigSisterIsrael-master\\\\BigBrotherBigSisterIsrael-master\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/createSuper\";import React,{Component}from\"react\";import firebase from\"../../config/Firebase\";import\"./LinkUsers.css\";var LinkUsers=/*#__PURE__*/function(_Component){_inherits(LinkUsers,_Component);var _super=_createSuper(LinkUsers);function LinkUsers(){var _this;_classCallCheck(this,LinkUsers);_this=_super.call(this);_this.isValid=function(querySnapshot,type){if(querySnapshot.empty){alert(\"ה\"+type+\" לא קיים במערכת\");throw Error(500);}querySnapshot.forEach(function(doc){if(doc.data().type!==type){alert(\"המשתמש אינו \"+type);throw Error(500);}if(type===\"חניך\")_this.setState({studentRef:doc.ref.id,studentName:doc.data().fName+\" \"+doc.data().lName});else if(type===\"חונך\")_this.setState({mentorRef:doc.ref.id,mentorName:doc.data().fName+\" \"+doc.data().lName});});};_this.verifyUsers=function(){var studentId=_this.state.studentId;var mentorId=_this.state.mentorId;_this.usersRef.where('id','==',studentId).limit(1).get().then(function(querySnapshot){return _this.isValid(querySnapshot,\"חניך\");}).then(function(){return _this.usersRef.where('id','==',mentorId).limit(1).get().then(function(querySnapshot){return _this.isValid(querySnapshot,\"חונך\");});}).then(function(){var con=window.confirm(\"האם אתה בטוח לבצונך לקשר את החונך \"+_this.state.mentorName+\" לחניך \"+_this.state.studentName+\"?\");if(con){_this.linkUser(studentId);_this.linkUser(mentorId);console.log(\"המשתמשים עודכנו בהצלחה!\");alert(\"עודכן בהצלחה!\\n\"+_this.state.mentorName+\" הוא החונך של \"+_this.state.studentName+\".\");_this.setState({studentId:\"\",mentorId:\"\"});}}).catch(function(){return console.log(\"Error in adding new user\");});};_this.linkUser=function(curr){var studentId=_this.state.studentId;var mentorId=_this.state.mentorId;var studentRef=_this.state.studentRef;var mentorRef=_this.state.mentorRef;_this.usersRef.where('id','==',curr).limit(1).get().then(function(querySnapshot){querySnapshot.forEach(function(doc){if(curr===studentId)doc.ref.update({link_user:mentorRef});else if(curr===mentorId)doc.ref.update({link_user:studentRef});});}).catch(function(e){return console.log(e.name);});};_this.addLink=function(event){event.preventDefault();_this.verifyUsers();};_this.state={studentId:\"\",mentorId:\"\",studentName:\"\",mentorName:\"\",studentRef:\"\",mentorRef:\"\"};_this.usersRef=firebase.firestore().collection('Users');return _this;}_createClass(LinkUsers,[{key:\"render\",value:function render(){var _this2=this;return/*#__PURE__*/React.createElement(\"form\",{className:\"ad-user-form\",onSubmit:this.addLink},/*#__PURE__*/React.createElement(\"header\",{className:\"title\"},/*#__PURE__*/React.createElement(\"h1\",{className:\"add-user-h\"},/*#__PURE__*/React.createElement(\"u\",null,\" \\u05E7\\u05D9\\u05E9\\u05D5\\u05E8 \\u05D7\\u05E0\\u05D9\\u05DA \\u05DC\\u05D7\\u05D5\\u05E0\\u05DA\"))),/*#__PURE__*/React.createElement(\"div\",{className:\"form-row\"},/*#__PURE__*/React.createElement(\"div\",{className:\"form-group col-md-6\"},/*#__PURE__*/React.createElement(\"label\",{className:\"first-link-input-btn\",htmlFor:\"inputLinkFirstName\"},\"\\u05EA\\u05E2\\u05D5\\u05D3\\u05EA \\u05D6\\u05D4\\u05D5\\u05EA \\u05D7\\u05E0\\u05D9\\u05DA\"),/*#__PURE__*/React.createElement(\"input\",{required:true,type:\"number\",className:\"form-control\",id:\"inputLinkFirstName\",value:this.state.studentId,placeholder:\"\\u05EA\\u05E2\\u05D5\\u05D3\\u05EA \\u05D6\\u05D4\\u05D5\\u05EA \\u05D7\\u05E0\\u05D9\\u05DA\",title:\"\\u05E9\\u05DD \\u05E4\\u05E8\\u05D8\\u05D9\",onChange:function onChange(e){return _this2.setState({studentId:e.target.value});}})),/*#__PURE__*/React.createElement(\"div\",{className:\"form-group col-md-6\"},/*#__PURE__*/React.createElement(\"label\",{className:\"last-link-input-btn\",htmlFor:\"inputLinkLastName\"},\"\\u05EA\\u05E2\\u05D5\\u05D3\\u05EA \\u05D6\\u05D4\\u05D5\\u05EA \\u05D7\\u05D5\\u05E0\\u05DA\"),/*#__PURE__*/React.createElement(\"input\",{required:true,type:\"number\",className:\"form-control\",id:\"inputLinkLastName\",value:this.state.mentorId,placeholder:\"\\u05EA\\u05E2\\u05D5\\u05D3\\u05EA \\u05D6\\u05D4\\u05D5\\u05EA \\u05D7\\u05D5\\u05E0\\u05DA\",onChange:function onChange(e){return _this2.setState({mentorId:e.target.value});}}),/*#__PURE__*/React.createElement(\"button\",{type:\"submit\",className:\"btn btn-primary link-users-btn\"},\"\\u05D4\\u05D5\\u05E1\\u05E3 \\u05E7\\u05D9\\u05E9\\u05D5\\u05E8\"))));}}]);return LinkUsers;}(Component);export default LinkUsers;","map":{"version":3,"sources":["C:/Users/ahmad/Downloads/BigBrotherBigSisterIsrael-master/BigBrotherBigSisterIsrael-master/src/adminComponents/partial/LinkUsers.jsx"],"names":["React","Component","firebase","LinkUsers","isValid","querySnapshot","type","empty","alert","Error","forEach","doc","data","setState","studentRef","ref","id","studentName","fName","lName","mentorRef","mentorName","verifyUsers","studentId","state","mentorId","usersRef","where","limit","get","then","con","window","confirm","linkUser","console","log","catch","curr","update","link_user","e","name","addLink","event","preventDefault","firestore","collection","target","value"],"mappings":"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","sourcesContent":["import React, { Component } from \"react\";\r\nimport firebase from \"../../config/Firebase\"\r\nimport \"./LinkUsers.css\";\r\n\r\nclass LinkUsers extends Component {\r\n    constructor() {\r\n        super();\r\n        this.state = {\r\n            studentId: \"\",\r\n            mentorId: \"\",\r\n            studentName: \"\",\r\n            mentorName: \"\",\r\n            studentRef: \"\",\r\n            mentorRef: \"\"\r\n        }\r\n        this.usersRef = firebase.firestore().collection('Users');\r\n    }\r\n\r\n    isValid = (querySnapshot, type) => {\r\n        if (querySnapshot.empty) {\r\n            alert(\"ה\" + type + \" לא קיים במערכת\")\r\n            throw Error(500);\r\n        }\r\n        querySnapshot.forEach(doc => {\r\n            if (doc.data().type !== type) {\r\n                alert(\"המשתמש אינו \" + type);\r\n                throw Error(500);\r\n            }\r\n            if (type === \"חניך\")\r\n                this.setState({ studentRef: doc.ref.id, studentName: doc.data().fName + \" \" + doc.data().lName })\r\n            else if (type === \"חונך\")\r\n                this.setState({ mentorRef: doc.ref.id, mentorName: doc.data().fName + \" \" + doc.data().lName })\r\n        });\r\n    }\r\n\r\n    verifyUsers = () => {\r\n        var studentId = this.state.studentId;\r\n        var mentorId = this.state.mentorId;\r\n        this.usersRef.where('id', '==', studentId)\r\n            .limit(1)\r\n            .get()\r\n            .then((querySnapshot) => this.isValid(querySnapshot, \"חניך\"))\r\n            .then(() => this.usersRef.where('id', '==', mentorId)\r\n                .limit(1)\r\n                .get()\r\n                .then((querySnapshot) => this.isValid(querySnapshot, \"חונך\")))\r\n            .then(() => {\r\n                var con = window.confirm(\"האם אתה בטוח לבצונך לקשר את החונך \" + this.state.mentorName + \" לחניך \" + this.state.studentName + \"?\")\r\n                if (con) {\r\n                    this.linkUser(studentId);\r\n                    this.linkUser(mentorId);\r\n                    console.log(\"המשתמשים עודכנו בהצלחה!\");\r\n                    alert(\"עודכן בהצלחה!\\n\" + this.state.mentorName + \" הוא החונך של \" + this.state.studentName + \".\");\r\n                    this.setState({ studentId: \"\", mentorId: \"\" });\r\n                }\r\n            })\r\n            .catch(() => console.log(\"Error in adding new user\"));\r\n    }\r\n\r\n    linkUser = (curr) => {\r\n        var studentId = this.state.studentId;\r\n        var mentorId = this.state.mentorId;\r\n        var studentRef = this.state.studentRef;\r\n        var mentorRef = this.state.mentorRef;\r\n        this.usersRef.where('id', '==', curr)\r\n            .limit(1)\r\n            .get()\r\n            .then((querySnapshot) => {\r\n                querySnapshot.forEach((doc) => {\r\n                    if (curr === studentId)\r\n                        doc.ref.update({ link_user: mentorRef })\r\n                    else if (curr === mentorId)\r\n                        doc.ref.update({ link_user: studentRef })\r\n                }\r\n                );\r\n            }).catch((e) => console.log(e.name));\r\n    }\r\n\r\n    addLink = (event) => {\r\n        event.preventDefault();\r\n        this.verifyUsers();\r\n    }\r\n\r\n    render() {\r\n        return (\r\n            <form className=\"ad-user-form\" onSubmit={this.addLink}>\r\n                <header className=\"title\">\r\n                    <h1 className=\"add-user-h\">\r\n                        <u> קישור חניך לחונך</u>\r\n                    </h1>\r\n                </header>\r\n                <div className=\"form-row\">\r\n                    <div className=\"form-group col-md-6\">\r\n                        <label className=\"first-link-input-btn\" htmlFor=\"inputLinkFirstName\">תעודת זהות חניך</label>\r\n                        <input\r\n                            required\r\n                            type=\"number\"\r\n                            className=\"form-control\"\r\n                            id=\"inputLinkFirstName\"\r\n                            value={this.state.studentId}\r\n                            placeholder=\"תעודת זהות חניך\"\r\n                            title=\"שם פרטי\"\r\n                            onChange={(e) => this.setState({ studentId: e.target.value })}\r\n                        />\r\n                    </div>\r\n                    <div className=\"form-group col-md-6\">\r\n                        <label className=\"last-link-input-btn\" htmlFor=\"inputLinkLastName\">תעודת זהות חונך</label>\r\n                        <input\r\n                            required\r\n                            type=\"number\"\r\n                            className=\"form-control\"\r\n                            id=\"inputLinkLastName\"\r\n                            value={this.state.mentorId}\r\n                            placeholder=\"תעודת זהות חונך\"\r\n                            onChange={(e) => this.setState({ mentorId: e.target.value })}\r\n                        />\r\n                        <button type=\"submit\" className=\"btn btn-primary link-users-btn\">\r\n                            הוסף קישור\r\n                         </button>\r\n                    </div>\r\n                </div>\r\n            </form>\r\n        );\r\n    }\r\n\r\n}\r\n\r\nexport default LinkUsers;"]},"metadata":{},"sourceType":"module"}