{"ast":null,"code":"var _jsxFileName = \"/Users/wadie/BigBrotherBigSisterIsrael/src/racazComponents/Meetings.jsx\";\nimport React, { Component } from \"react\";\nimport \"./Meetings.css\";\nimport firebase from \"../config/Firebase\";\nimport MeetingList from \"../navBarComponents/meetingComponents/MeetingList\";\nimport $ from \"jquery\";\n\nclass Meetings extends Component {\n  constructor(props) {\n    super(props);\n\n    this.getMeetings = () => {\n      var newMeetingObj;\n      var futureMeetings = this.myMeetingsRef.where('timeStamp', \">=\", Date.now() / 1000 - 7200).orderBy(\"timeStamp\", \"desc\");\n      futureMeetings.get().then(querySnap => {\n        this.setState({\n          lastMeetingVisible: querySnap.docs[querySnap.docs.length - 1],\n          futureLength: querySnap.docs.length\n        }, () => {\n          if (querySnap.empty) this.setState({\n            lastMeetingVisible: {\n              timeStamp: Date.now() / 1000 - 7200\n            }\n          });else if (typeof this.state.lastMeetingVisible === 'undefined') this.setState({\n            loadedAll: true\n          });\n        });\n        querySnap.forEach(doc => {\n          newMeetingObj = {};\n          Object.assign(newMeetingObj, doc.data());\n          newMeetingObj.doc_id = doc.id;\n          this.setState({\n            meetings: [...this.state.meetings, newMeetingObj]\n          });\n        });\n      }).then(() => this.setState({\n        loadingFromFirebase: false\n      })).catch(e => console.log(e.name));\n    };\n\n    this.updateTableAfterDelete = meetingsArr => {\n      this.setState({\n        meetings: [...meetingsArr]\n      });\n    };\n\n    this.loadPrev = () => {\n      if (typeof this.state.lastMeetingVisible === 'undefined') return;\n      var startFrom;\n      if (typeof this.state.lastMeetingVisible.timeStamp === 'undefined') startFrom = this.state.lastMeetingVisible.data().timeStamp;else startFrom = this.state.lastMeetingVisible.timeStamp;\n      this.setState({\n        loadingPastMeetings: true\n      });\n      var newMeetingObj;\n      this.myMeetingsRef.orderBy(\"timeStamp\", \"desc\").startAfter(startFrom).limit(5).get().then(querySnap => {\n        if (querySnap.docs.length < 5) this.setState({\n          loadedAll: true\n        });\n        if (querySnap.docs.length === 0) return;\n        this.setState({\n          lastMeetingVisible: querySnap.docs[querySnap.docs.length - 1]\n        });\n        querySnap.forEach(doc => {\n          newMeetingObj = {};\n          Object.assign(newMeetingObj, doc.data());\n          newMeetingObj.doc_id = doc.id;\n          this.setState({\n            meetings: [...this.state.meetings, newMeetingObj]\n          });\n        });\n      }).then(() => this.setState({\n        loadingPastMeetings: false\n      })).catch(e => console.log(e.name));\n    };\n\n    this.getTable = () => {\n      return /*#__PURE__*/React.createElement(MeetingList, {\n        className: \"meeting-list\",\n        meetingsArr: this.state.meetings,\n        loading: this.state.loadingFromFirebase,\n        myUser: this.myMeetingsRef,\n        linkUser: this.mateMeetingsRef,\n        updateRef: this.updateTableAfterDelete,\n        loadPrev: this.loadPrev,\n        loadedAll: this.state.loadedAll,\n        futureLength: this.state.futureLength,\n        loadingPastMeetings: this.state.loadingPastMeetings,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 111,\n          columnNumber: 12\n        }\n      });\n    };\n\n    this.handleSubmit = event => {\n      event.preventDefault();\n      var isSure;\n\n      if (!this.state.scheduled) {\n        isSure = window.confirm(\"האם ברצונך לקבוע פגישה:\\nבתאריך: \" + this.state.date + \"\\nבשעה: \" + this.state.time + \"\\nבמיקום: \" + this.state.place);\n      } else isSure = window.confirm(\"האם ברצונך לקבוע 13 פגישות קבועות לשלושת החודשים הקרובים:\\nהחל מתאריך: \" + this.state.date + \"\\nבשעה: \" + this.state.time + \"\\nבמיקום: \" + this.state.place);\n\n      if (isSure) {\n        var amount_of_meetings = this.state.scheduled ? 13 : 1;\n        var dates = [],\n            newMeetings = [],\n            newMeetingObj = [];\n\n        for (let i = 0; i < amount_of_meetings; i++) {\n          var nextDate = new Date(Date.parse(this.state.date) + 7 * 24 * 60 * 60 * 1000 * i);\n          dates.push(nextDate.getFullYear() + \"-\" + (nextDate.getMonth() + 1) + \"-\" + nextDate.getDate());\n          var time_stamp = Date.parse(dates[i] + \" \" + this.state.time) / 1000;\n          let selected_list = \"\";\n          var checked_list = $('.people_check:checked');\n          checked_list.forEach(function (item) {\n            if (selected_list !== \"\") selected_list += \",\";\n            selected_list += $(this).parent().attr('person_id');\n          });\n          newMeetings.push({\n            date: dates[i],\n            send_list: selected_list,\n            timeStamp: time_stamp,\n            place: this.state.place,\n            description: this.state.description\n          });\n          newMeetingObj.push({});\n          this.myMeetingsRef.add(newMeetings[i]).then(docRef => {\n            this.newDocId = docRef.id;\n            this.mateMeetingsRef.doc(docRef.id).set(newMeetings[i]);\n          }).then(() => {\n            if (!this.state.scheduled && this.state.date !== \"\") {\n              alert(\"נקבעה פגישה בתאריך: \" + this.state.date + \"\\nבשעה: \" + this.state.time + \"\\nבמיקום: \" + this.state.place);\n            } else if (i === 0) alert(\"נקבעו 13 פגישות קבועות לשלושת החודשים הקרובים.\");\n\n            Object.assign(newMeetingObj[i], newMeetings[i]);\n            newMeetingObj[i].doc_id = this.newDocId;\n            const d = [].concat(this.state.meetings).concat(newMeetingObj[i]).sort((a, b) => this.sortFunc(a, b));\n            this.setState({\n              meetings: [...d],\n              date: \"\",\n              time: \"\",\n              place: \"\",\n              description: \"\",\n              scheduled: false\n            });\n          }).catch(e => console.log(e.name));\n        }\n      }\n    };\n\n    this.sortFunc = (a, b) => {\n      if (a.timeStamp > b.timeStamp) return -1;\n      if (a.timeStamp < b.timeStamp) return 1;\n      return 0;\n    };\n\n    this.state = {\n      meetings: [],\n      date: \"\",\n      time: \"\",\n      place: \"\",\n      description: \"\",\n      loadingFromFirebase: true,\n      lastMeetingVisible: null,\n      loadedAll: false,\n      futureLength: 0,\n      loadingPastMeetings: false,\n      scheduled: false\n    };\n    this.newDocId = \"\";\n    this.people = [];\n    this.myMeetingsRef = firebase.firestore().collection('Users').doc(firebase.auth().currentUser.uid).collection('Meetings');\n    firebase.firestore().collection('Users').doc(firebase.auth().currentUser.uid).get().then(doc => {\n      this.linkUser = doc.data().link_user;\n      this.mateMeetingsRef = firebase.firestore().collection('Users').doc(this.linkUser).collection('Meetings');\n    }).catch(e => console.log(e.name));\n    firebase.firestore().collection('Users').get().then(querySnapshot => {\n      querySnapshot.docs.map(doc => {\n        console.log(doc.data());\n        this.people.push({\n          id: doc.data().id,\n          name: doc.data().fName + \" \" + doc.data().lName,\n          type: doc.data().type\n        });\n        return null;\n      });\n    });\n  }\n\n  componentDidMount() {\n    this.getMeetings();\n  }\n\n  render() {\n    return /*#__PURE__*/React.createElement(\"div\", {\n      className: \"main-background\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 212,\n        columnNumber: 7\n      }\n    }, /*#__PURE__*/React.createElement(\"form\", {\n      className: \"meeting-form\",\n      onSubmit: this.handleSubmit,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 213,\n        columnNumber: 9\n      }\n    }, /*#__PURE__*/React.createElement(\"br\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 214,\n        columnNumber: 11\n      }\n    }), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"form-group\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 215,\n        columnNumber: 11\n      }\n    }, /*#__PURE__*/React.createElement(\"h1\", {\n      className: \"meeting-title\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 216,\n        columnNumber: 13\n      }\n    }, /*#__PURE__*/React.createElement(\"u\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 216,\n        columnNumber: 43\n      }\n    }, \"\\u05E7\\u05D1\\u05D9\\u05E2\\u05EA \\u05E4\\u05D2\\u05D9\\u05E9\\u05D4\")), /*#__PURE__*/React.createElement(\"label\", {\n      className: \"fLabels\",\n      style: {\n        float: \"right\"\n      },\n      htmlFor: \"date\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 218,\n        columnNumber: 13\n      }\n    }, \"\\u05EA\\u05D0\\u05E8\\u05D9\\u05DA \\u05D4\\u05E4\\u05D2\\u05D9\\u05E9\\u05D4\"), /*#__PURE__*/React.createElement(\"input\", {\n      onChange: e => this.setState({\n        date: e.target.value\n      }),\n      type: \"date\",\n      className: \"form-control\",\n      id: \"date\",\n      placeholder: \"\\u05EA\\u05D0\\u05E8\\u05D9\\u05DA \\u05D4\\u05E4\\u05D2\\u05D9\\u05E9\\u05D4\",\n      value: this.state.date,\n      required: true,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 225,\n        columnNumber: 13\n      }\n    })), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"form-group\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 235,\n        columnNumber: 11\n      }\n    }, /*#__PURE__*/React.createElement(\"label\", {\n      className: \"fLabels\",\n      style: {\n        float: \"right\"\n      },\n      htmlFor: \"hour\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 236,\n        columnNumber: 13\n      }\n    }, \"\\u05E9\\u05E2\\u05EA \\u05D4\\u05E4\\u05D2\\u05D9\\u05E9\\u05D4\"), /*#__PURE__*/React.createElement(\"input\", {\n      onChange: e => this.setState({\n        time: e.target.value\n      }),\n      type: \"time\",\n      className: \"form-control\",\n      id: \"hour\",\n      placeholder: \"\\u05E9\\u05E2\\u05EA \\u05D4\\u05E4\\u05D2\\u05D9\\u05E9\\u05D4\",\n      value: this.state.time,\n      required: true,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 243,\n        columnNumber: 13\n      }\n    })), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"form-group\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 253,\n        columnNumber: 11\n      }\n    }, /*#__PURE__*/React.createElement(\"label\", {\n      className: \"fLabels\",\n      style: {\n        float: \"right\"\n      },\n      htmlFor: \"place\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 254,\n        columnNumber: 13\n      }\n    }, \"\\u05DE\\u05D9\\u05E7\\u05D5\\u05DD \\u05D4\\u05E4\\u05D2\\u05D9\\u05E9\\u05D4\"), /*#__PURE__*/React.createElement(\"input\", {\n      onChange: e => this.setState({\n        place: e.target.value\n      }),\n      type: \"text\",\n      className: \"form-control\",\n      id: \"place\",\n      placeholder: \"\\u05DE\\u05D9\\u05E7\\u05D5\\u05DD \\u05D4\\u05E4\\u05D2\\u05D9\\u05E9\\u05D4\",\n      value: this.state.place,\n      required: true,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 261,\n        columnNumber: 13\n      }\n    })), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"form-group\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 271,\n        columnNumber: 11\n      }\n    }, /*#__PURE__*/React.createElement(\"label\", {\n      className: \"fLabels\",\n      style: {\n        float: \"right\"\n      },\n      htmlFor: \"description\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 272,\n        columnNumber: 13\n      }\n    }, \"\\u05EA\\u05D9\\u05D0\\u05D5\\u05E8\"), /*#__PURE__*/React.createElement(\"input\", {\n      onChange: e => this.setState({\n        description: e.target.value\n      }),\n      type: \"text\",\n      className: \"form-control\",\n      id: \"description\",\n      value: this.state.description,\n      placeholder: \"\\u05EA\\u05D9\\u05D0\\u05D5\\u05E8\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 280,\n        columnNumber: 13\n      }\n    })), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"form-group\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 289,\n        columnNumber: 11\n      }\n    }, /*#__PURE__*/React.createElement(\"label\", {\n      className: \"fLabels\",\n      style: {\n        float: \"right\"\n      },\n      htmlFor: \"description\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 290,\n        columnNumber: 13\n      }\n    }, \"\\u05DE\\u05E9\\u05EA\\u05EA\\u05E4\\u05D9\\u05DD\"), /*#__PURE__*/React.createElement(\"table\", {\n      class: \"table table-bordered\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 298,\n        columnNumber: 13\n      }\n    }, /*#__PURE__*/React.createElement(\"thead\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 299,\n        columnNumber: 15\n      }\n    }, /*#__PURE__*/React.createElement(\"tr\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 300,\n        columnNumber: 17\n      }\n    }, /*#__PURE__*/React.createElement(\"td\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 301,\n        columnNumber: 19\n      }\n    }, \"\\u05EA.\\u05D6\"), /*#__PURE__*/React.createElement(\"td\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 302,\n        columnNumber: 19\n      }\n    }, \"\\u05E9\\u05DD\"), /*#__PURE__*/React.createElement(\"td\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 303,\n        columnNumber: 19\n      }\n    }, \"\\u05E1\\u05D5\\u05D2 \\u05DE\\u05E9\\u05EA\\u05DE\\u05E9\"), /*#__PURE__*/React.createElement(\"td\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 304,\n        columnNumber: 19\n      }\n    }, \"\\u05D1\\u05D7\\u05E8\"))), /*#__PURE__*/React.createElement(\"tbody\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 307,\n        columnNumber: 15\n      }\n    }, this.people.map((person, index) => /*#__PURE__*/React.createElement(\"tr\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 309,\n        columnNumber: 21\n      }\n    }, /*#__PURE__*/React.createElement(\"td\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 309,\n        columnNumber: 25\n      }\n    }, person.id), /*#__PURE__*/React.createElement(\"td\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 309,\n        columnNumber: 45\n      }\n    }, person.name), /*#__PURE__*/React.createElement(\"td\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 309,\n        columnNumber: 67\n      }\n    }, person.type), /*#__PURE__*/React.createElement(\"td\", {\n      person_id: person.id,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 310,\n        columnNumber: 21\n      }\n    }, /*#__PURE__*/React.createElement(\"input\", {\n      type: \"checkbox\",\n      class: \"people_check\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 310,\n        columnNumber: 47\n      }\n    }))))))), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"form-group\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 315,\n        columnNumber: 11\n      }\n    }, /*#__PURE__*/React.createElement(\"input\", {\n      type: \"checkbox\",\n      className: \"form-check-input w-25\",\n      id: \"scheduledMeeting\",\n      checked: this.state.scheduled,\n      onChange: e => this.setState({\n        scheduled: !this.state.scheduled\n      }),\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 316,\n        columnNumber: 13\n      }\n    }), /*#__PURE__*/React.createElement(\"label\", {\n      className: \"form-check-label check-meeting-lbl w-75\",\n      style: {\n        float: \"right\"\n      },\n      htmlFor: \"description\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 323,\n        columnNumber: 13\n      }\n    }, \"\\u05E4\\u05D2\\u05D9\\u05E9\\u05D5\\u05EA \\u05E7\\u05D1\\u05D5\\u05E2\\u05D5\\u05EA - \\u05DC\\u05E9\\u05DC\\u05D5\\u05E9\\u05EA \\u05D4\\u05D7\\u05D5\\u05D3\\u05E9\\u05D9\\u05DD \\u05D4\\u05E7\\u05E8\\u05D5\\u05D1\\u05D9\\u05DD\")), /*#__PURE__*/React.createElement(\"br\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 331,\n        columnNumber: 11\n      }\n    }), /*#__PURE__*/React.createElement(\"button\", {\n      className: \"btn btn-success setup-meeting-btn\",\n      style: {\n        float: \"right\",\n        marginRight: \"700px\"\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 332,\n        columnNumber: 11\n      }\n    }, \"\\u05E7\\u05D1\\u05E2 \\u05E4\\u05D2\\u05D9\\u05E9\\u05D4!\", \" \")), this.getTable());\n  }\n\n}\n\nexport default Meetings;","map":{"version":3,"sources":["/Users/wadie/BigBrotherBigSisterIsrael/src/racazComponents/Meetings.jsx"],"names":["React","Component","firebase","MeetingList","$","Meetings","constructor","props","getMeetings","newMeetingObj","futureMeetings","myMeetingsRef","where","Date","now","orderBy","get","then","querySnap","setState","lastMeetingVisible","docs","length","futureLength","empty","timeStamp","state","loadedAll","forEach","doc","Object","assign","data","doc_id","id","meetings","loadingFromFirebase","catch","e","console","log","name","updateTableAfterDelete","meetingsArr","loadPrev","startFrom","loadingPastMeetings","startAfter","limit","getTable","mateMeetingsRef","handleSubmit","event","preventDefault","isSure","scheduled","window","confirm","date","time","place","amount_of_meetings","dates","newMeetings","i","nextDate","parse","push","getFullYear","getMonth","getDate","time_stamp","selected_list","checked_list","item","parent","attr","send_list","description","add","docRef","newDocId","set","alert","d","concat","sort","a","b","sortFunc","people","firestore","collection","auth","currentUser","uid","linkUser","link_user","querySnapshot","map","fName","lName","type","componentDidMount","render","float","target","value","person","index","marginRight"],"mappings":"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","sourcesContent":["import React, { Component } from \"react\";\nimport \"./Meetings.css\";\nimport firebase from \"../config/Firebase\"\nimport MeetingList from \"../navBarComponents/meetingComponents/MeetingList\"\nimport $ from \"jquery\"\nclass Meetings extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      meetings: [],\n      date: \"\",\n      time: \"\",\n      place: \"\",\n      description: \"\",\n      loadingFromFirebase: true,\n      lastMeetingVisible: null,\n      loadedAll: false,\n      futureLength: 0,\n      loadingPastMeetings: false,\n      scheduled: false\n    };\n    this.newDocId = \"\";\n    this.people = [];\n    this.myMeetingsRef = firebase.firestore().collection('Users').doc(firebase.auth().currentUser.uid).collection('Meetings');\n    firebase.firestore().collection('Users').doc(firebase.auth().currentUser.uid).get()\n      .then((doc) => {\n        this.linkUser = doc.data().link_user;\n        this.mateMeetingsRef = firebase.firestore().collection('Users').doc(this.linkUser).collection('Meetings');\n      })\n      .catch((e) => console.log(e.name))\n    firebase.firestore().collection('Users').get().then((querySnapshot) => {\n      querySnapshot.docs.map((doc) => {\n        console.log(doc.data());\n        this.people.push({\n          id: doc.data().id,\n          name: doc.data().fName + \" \" + doc.data().lName,\n          type:  doc.data().type\n        });\n        return null;\n      });\n    });\n  }\n\n  getMeetings = () => {\n    var newMeetingObj;\n    var futureMeetings = this.myMeetingsRef\n      .where('timeStamp', \">=\", ((Date.now() / 1000) - 7200))\n      .orderBy(\"timeStamp\", \"desc\")\n\n    futureMeetings\n      .get()\n      .then((querySnap) => {\n        this.setState({ lastMeetingVisible: querySnap.docs[querySnap.docs.length - 1], futureLength: querySnap.docs.length }, () => {\n          if (querySnap.empty)\n            this.setState({ lastMeetingVisible: { timeStamp: ((Date.now() / 1000) - 7200) } })\n          else if (typeof (this.state.lastMeetingVisible) === 'undefined')\n            this.setState({ loadedAll: true })\n        })\n        querySnap.forEach((doc) => {\n          newMeetingObj = {};\n          Object.assign(newMeetingObj, doc.data());\n          newMeetingObj.doc_id = doc.id;\n          this.setState({ meetings: [...this.state.meetings, newMeetingObj] })\n        })\n      })\n      .then(() => this.setState({ loadingFromFirebase: false }))\n      .catch((e) => console.log(e.name))\n  }\n\n  componentDidMount() {\n    this.getMeetings();\n  }\n\n  updateTableAfterDelete = (meetingsArr) => {\n    this.setState({ meetings: [...meetingsArr] });\n  }\n\n  loadPrev = () => {\n    if (typeof (this.state.lastMeetingVisible) === 'undefined')\n      return;\n    var startFrom;\n    if (typeof (this.state.lastMeetingVisible.timeStamp) === 'undefined')\n      startFrom = this.state.lastMeetingVisible.data().timeStamp;\n    else\n      startFrom = this.state.lastMeetingVisible.timeStamp;\n    this.setState({ loadingPastMeetings: true });\n    var newMeetingObj;\n    this.myMeetingsRef\n      .orderBy(\"timeStamp\", \"desc\")\n      .startAfter(startFrom)\n      .limit(5)\n      .get()\n      .then((querySnap) => {\n        if (querySnap.docs.length < 5)\n          this.setState({ loadedAll: true })\n        if (querySnap.docs.length === 0)\n          return;\n        this.setState({ lastMeetingVisible: querySnap.docs[querySnap.docs.length - 1] })\n        querySnap.forEach((doc) => {\n          newMeetingObj = {};\n          Object.assign(newMeetingObj, doc.data());\n          newMeetingObj.doc_id = doc.id;\n          this.setState({ meetings: [...this.state.meetings, newMeetingObj] });\n        })\n      })\n      .then(() => this.setState({ loadingPastMeetings: false }))\n      .catch((e) => console.log(e.name))\n  }\n\n  getTable = () => {\n    return <MeetingList\n      className=\"meeting-list\"\n      meetingsArr={this.state.meetings}\n      loading={this.state.loadingFromFirebase}\n      myUser={this.myMeetingsRef}\n      linkUser={this.mateMeetingsRef}\n      updateRef={this.updateTableAfterDelete}\n      loadPrev={this.loadPrev}\n      loadedAll={this.state.loadedAll}\n      futureLength={this.state.futureLength}\n      loadingPastMeetings={this.state.loadingPastMeetings}\n    />\n  }\n\n  handleSubmit = (event) => {\n    event.preventDefault();\n    var isSure;\n    if (!this.state.scheduled) {\n      isSure = window.confirm(\n        \"האם ברצונך לקבוע פגישה:\\nבתאריך: \" +\n        this.state.date +\n        \"\\nבשעה: \" +\n        this.state.time +\n        \"\\nבמיקום: \" +\n        this.state.place\n      );\n    }\n    else\n      isSure = window.confirm(\n        \"האם ברצונך לקבוע 13 פגישות קבועות לשלושת החודשים הקרובים:\\nהחל מתאריך: \" +\n        this.state.date +\n        \"\\nבשעה: \" +\n        this.state.time +\n        \"\\nבמיקום: \" +\n        this.state.place\n      );\n    if (isSure) {\n      var amount_of_meetings = this.state.scheduled ? 13 : 1;\n      var dates = [], newMeetings = [], newMeetingObj = [];\n      for (let i = 0; i < amount_of_meetings; i++) {\n        var nextDate = (new Date(Date.parse(this.state.date) + (7 * 24 * 60 * 60 * 1000) * i));\n        dates.push(nextDate.getFullYear() + \"-\" + (nextDate.getMonth() + 1) + \"-\" + nextDate.getDate());\n        var time_stamp = (((Date.parse(dates[i] + \" \" + this.state.time)) / 1000));\n        let selected_list = \"\";\n        var checked_list = $('.people_check:checked');\n        checked_list.forEach(function(item){\n          if(selected_list!==\"\")selected_list += \",\";\n          selected_list += $(this).parent().attr('person_id');\n        });\n        newMeetings.push({\n          date: dates[i],\n          send_list: selected_list,\n          timeStamp: time_stamp,\n          place: this.state.place,\n          description: this.state.description\n        })\n        newMeetingObj.push({});\n        this.myMeetingsRef.add(newMeetings[i])\n          .then((docRef) => {\n            this.newDocId = docRef.id;\n            this.mateMeetingsRef.doc(docRef.id).set(newMeetings[i]);\n          })\n          .then(() => {\n            if (!this.state.scheduled && this.state.date !== \"\") {\n              alert(\n                \"נקבעה פגישה בתאריך: \" +\n                this.state.date +\n                \"\\nבשעה: \" +\n                this.state.time +\n                \"\\nבמיקום: \" +\n                this.state.place\n              );\n            }\n            else if (i === 0)\n              alert(\n                \"נקבעו 13 פגישות קבועות לשלושת החודשים הקרובים.\"\n              );\n            Object.assign(newMeetingObj[i], newMeetings[i]);\n            newMeetingObj[i].doc_id = this.newDocId;\n            const d = [].concat(this.state.meetings).concat(newMeetingObj[i]).sort((a, b) => this.sortFunc(a, b));\n            this.setState({\n              meetings: [...d],\n              date: \"\", time: \"\", place: \"\", description: \"\", scheduled: false\n            });\n          })\n          .catch((e) => console.log(e.name));\n      }\n    }\n  }\n\n  sortFunc = (a, b) => {\n    if (a.timeStamp > b.timeStamp)\n      return -1;\n    if (a.timeStamp < b.timeStamp)\n      return 1;\n    return 0;\n  }\n\n  render() {\n    \n    return (\n      <div className=\"main-background\" >\n        <form className=\"meeting-form\" onSubmit={this.handleSubmit}>\n          <br />\n          <div className=\"form-group\">\n            <h1 className=\"meeting-title\"><u>קביעת פגישה</u></h1>\n\n            <label\n              className=\"fLabels\"\n              style={{ float: \"right\" }}\n              htmlFor=\"date\"\n            >\n              תאריך הפגישה\n            </label>\n            <input\n              onChange={(e) => this.setState({ date: e.target.value })}\n              type=\"date\"\n              className=\"form-control\"\n              id=\"date\"\n              placeholder=\"תאריך הפגישה\"\n              value={this.state.date}\n              required\n            />\n          </div>\n          <div className=\"form-group\">\n            <label\n              className=\"fLabels\"\n              style={{ float: \"right\" }}\n              htmlFor=\"hour\"\n            >\n              שעת הפגישה\n            </label>\n            <input\n              onChange={(e) => this.setState({ time: e.target.value })}\n              type=\"time\"\n              className=\"form-control\"\n              id=\"hour\"\n              placeholder=\"שעת הפגישה\"\n              value={this.state.time}\n              required\n            />\n          </div>\n          <div className=\"form-group\">\n            <label\n              className=\"fLabels\"\n              style={{ float: \"right\" }}\n              htmlFor=\"place\"\n            >\n              מיקום הפגישה\n            </label>\n            <input\n              onChange={(e) => this.setState({ place: e.target.value })}\n              type=\"text\"\n              className=\"form-control\"\n              id=\"place\"\n              placeholder=\"מיקום הפגישה\"\n              value={this.state.place}\n              required\n            />\n          </div>\n          <div className=\"form-group\">\n            <label\n              className=\"fLabels\"\n              style={{ float: \"right\" }}\n              htmlFor=\"description\"\n            >\n             {/* <!-description--> */}\n              תיאור \n            </label>\n            <input\n              onChange={(e) => this.setState({ description: e.target.value })}\n              type=\"text\"\n              className=\"form-control\"\n              id=\"description\"\n              value={this.state.description}\n              placeholder=\"תיאור\"\n            />\n          </div>\n          <div className=\"form-group\">\n            <label\n              className=\"fLabels\"\n              style={{ float: \"right\" }}\n              htmlFor=\"description\"\n            >\n             {/* <!-description--> */}\n             משתתפים\n            </label>\n            <table class=\"table table-bordered\">\n              <thead>\n                <tr>\n                  <td>ת.ז</td>\n                  <td>שם</td>\n                  <td>סוג משתמש</td>\n                  <td>בחר</td>\n                  </tr>\n              </thead>\n              <tbody>\n                {this.people.map((person, index) => (\n                    <tr><td>{person.id}</td><td>{person.name}</td><td>{person.type}</td>\n                    <td person_id={person.id}><input type='checkbox' class='people_check'/></td></tr>\n                ))}\n              </tbody>\n            </table>\n          </div>\n          <div className=\"form-group\">\n            <input\n              type=\"checkbox\"\n              className=\"form-check-input w-25\"\n              id=\"scheduledMeeting\"\n              checked={this.state.scheduled}\n              onChange={(e) => this.setState({ scheduled: !this.state.scheduled })}\n            />\n            <label\n              className=\"form-check-label check-meeting-lbl w-75\"\n              style={{ float: \"right\" }}\n              htmlFor=\"description\"\n            >\n              פגישות קבועות - לשלושת החודשים הקרובים\n            </label>\n          </div>\n          <br />\n          <button\n            className=\"btn btn-success setup-meeting-btn\"\n            style={{ float: \"right\", marginRight: \"700px\" }}\n          >\n            קבע פגישה!{\" \"}\n          </button>\n        </form>\n        {this.getTable()}\n      </div >\n    );\n  }\n}\n\nexport default Meetings;\n"]},"metadata":{},"sourceType":"module"}