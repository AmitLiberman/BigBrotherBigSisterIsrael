{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\ahmad\\\\Downloads\\\\BigBrotherBigSisterIsrael-master\\\\BigBrotherBigSisterIsrael-master\\\\src\\\\racazComponents\\\\RacazPage.jsx\";\nimport React, { Component } from \"react\";\nimport Meeting from \"../navBarComponents/meetingComponents/Meeting\";\nimport WallPost from \"../navBarComponents/wallComponents/wall/WallPost\";\nimport Profile from \"../navBarComponents/wallComponents/profile/Profile\";\nimport HomePage from \"../navBarComponents/homeComponents/HomePage\";\nimport VideoPage from \"../navBarComponents/videoComponents/main/VideoPage\";\nimport ChangePassword from \"../mainPageComponents/ChangePassword\";\nimport \"./RacazPage.css\";\nimport \"bootstrap/dist/css/bootstrap.min.css\";\nimport firebase from \"../config/Firebase\";\nimport Loader from 'react-loader-spinner';\nimport logo from '../static_pictures/big_brothers_big_sisters.png';\nimport { BrowserRouter as Router, Switch, Route, NavLink, Redirect } from \"react-router-dom\";\n\nclass RacazPage extends Component {\n  constructor(props) {\n    super(props);\n\n    this.logout = () => {\n      var logOutConfirm = window.confirm(\"האם אתה בטוח שברצונך להתנתק מהמערכת?\");\n      if (!logOutConfirm) return;\n      if (this.state.isMounted) this.updateDisconnection();\n      firebase.auth().signOut().then(() => {\n        console.log(\"Successful sign-out\"); // Sign-out successful.\n      }).catch(error => {\n        console.log(\"Sign-out error\"); // An error happened.\n      });\n    };\n\n    this.resizeWin = e => {\n      this.setState({\n        zoom: Math.min(window.innerHeight / 620, window.innerWidth / 1536)\n      });\n    };\n\n    this.getUserName = () => {\n      if (firebase.auth().currentUser === null) return;\n      var currUserUid = firebase.firestore().collection('Users').doc(this.currUserUid);\n      currUserUid.get().then(uDetail => {\n        if (!uDetail.exists) {\n          alert(\"משתמש זה לא קיים יותר במערכת. אנא פנה למנהל.\");\n          firebase.auth().signOut();\n        } else {\n          this.setState({\n            userDetails: uDetail.data()\n          }, () => this.setState({\n            loadingUser: false\n          }));\n        }\n      }).catch(e => console.log(e.name));\n    };\n\n    this.setLinkedUser = doc => {\n      this.setState({\n        linkedUserDetails: doc.data()\n      });\n      this.setState({\n        loadingLinkedUser: false\n      });\n    };\n\n    this.getLinkedUser = () => {\n      var docRef = this.usersRef.doc(this.state.userDetails.link_user);\n      docRef.get().then(doc => this.setLinkedUser(doc)).catch(e => console.log(e.name));\n    };\n\n    this.getNextMeeting = () => {\n      var meetingRef = this.usersRef.doc(this.currUserUid).collection('Meetings');\n      meetingRef.where('timeStamp', \">=\", Date.now() / 1000 - 900).orderBy(\"timeStamp\", \"asc\").limit(1).get().then(querySnap => {\n        if (!querySnap.empty) this.setState({\n          next_meeting: querySnap.docs[0].data()\n        });else this.setState({\n          next_meeting: null\n        });\n      }).then(() => this.setState({\n        loadingNextMeeting: false\n      })).catch(e => console.log(e.name));\n    };\n\n    this.checkIfVideo = event => {\n      if (this.state.isOnVideo) {\n        var con = window.confirm(\"האם אתה בטוח שברצונך לסיים את שיחת הוידאו?\");\n        if (con) this.setState({\n          directVid: false,\n          hostVid: null,\n          isOnVideo: false\n        });else event.preventDefault();\n      } else if (this.state.notAllowed) this.setState({\n        directVid: false,\n        hostVid: null,\n        isOnVideo: false\n      });\n    };\n\n    this.modifyVideoStream = (localSt, remoteSt) => {\n      this.setState({\n        isOnVideo: true\n      });\n    };\n\n    this.modifyVideoNotAllowed = () => {\n      this.setState({\n        notAllowed: true\n      });\n    };\n\n    this.updateConnection = () => {\n      var myConnectionsRef = firebase.database().ref('users/' + this.state.userDetails.id + '/connected');\n      var lastOnlineRef = firebase.database().ref('users/' + this.state.userDetails.id + '/lastOnline');\n      var friendConnectionsRef = firebase.database().ref('users/' + this.state.linkedUserDetails.id + '/connected');\n      var friendOnlineRef = firebase.database().ref('users/' + this.state.linkedUserDetails.id + '/lastOnline');\n      this.connectionRef.on('value', snap => {\n        if (snap.val() === true) {\n          var con = myConnectionsRef.push();\n          con.onDisconnect().remove(this.removeDocs);\n          this.setState({\n            connectionKey: con.key\n          });\n          con.set(true);\n          lastOnlineRef.onDisconnect().set(firebase.database.ServerValue.TIMESTAMP);\n        }\n      });\n      friendConnectionsRef.on('value', snap => {\n        if (snap.val() !== null) this.setState({\n          otherUserConnection: true\n        });else this.setState({\n          otherUserConnection: false\n        });\n      });\n      friendOnlineRef.on('value', snap => {\n        this.setState({\n          otherUserLastOnline: snap.val()\n        });\n      });\n    };\n\n    this.removeDocs = () => {\n      var ref = this.usersRef.doc(this.state.userDetails.link_user).collection('Rooms');\n      ref.get().then(querySnapshot => {\n        querySnapshot.forEach(doc => {\n          doc.ref.collection('first_participant').get().then(subSnap => {\n            subSnap.forEach(subDoc => subDoc.ref.delete());\n            doc.ref.collection('second_participant').get().then(subSnap => subSnap.forEach(subDoc => subDoc.ref.delete()));\n          }).then(() => {\n            doc.ref.delete();\n          });\n        });\n      }).then(() => {\n        console.log(\"Docs has removed successfully\");\n      }).catch(() => {\n        console.log(\"Problem in removing Doc\");\n      });\n    };\n\n    this.updateDisconnection = () => {\n      var myConnectionsRef = firebase.database().ref('users/' + this.state.userDetails.id + '/connected');\n      var lastOnlineRef = firebase.database().ref('users/' + this.state.userDetails.id + '/lastOnline');\n      myConnectionsRef.child('/' + this.state.connectionKey).remove();\n      lastOnlineRef.set(firebase.database.ServerValue.TIMESTAMP);\n    };\n\n    this.getProfilePictures = () => {\n      this.myProfilePicturesRef.getDownloadURL().then(url => this.setState({\n        profilePicture: url\n      })).catch(e => console.log(e.name));\n      this.usersRef.doc(this.currUserUid).get().then(doc => this.setState({\n        link_user: doc.data().link_user\n      }, () => {\n        this.cloudRef.child('profile_pictures/' + this.state.link_user).getDownloadURL().then(url => this.setState({\n          friendProfile: url\n        })).catch(e => console.log(e.name));\n      })).catch(e => console.log(e.name));\n    };\n\n    this.changeProfilePictue = url => {\n      this.setState({\n        profilePicture: url\n      });\n    };\n\n    this.directVid = hosting => {\n      this.setState({\n        directVid: true,\n        hostVid: hosting\n      });\n    };\n\n    this.hrefClick = e => {\n      var con = window.confirm(\"האם אתה בטוח שברצונך לעזוב את האתר?\");\n      if (!con) e.preventDefault();\n    };\n\n    this.routeToVideo = () => {\n      if (this.state.directVid) return /*#__PURE__*/React.createElement(Redirect, {\n        push: true,\n        to: \"/VideoPage\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 308,\n          columnNumber: 15\n        }\n      });\n      return null;\n    };\n\n    this.getWallRouteStatus = () => {\n      this.setState({\n        routeToWall: true\n      });\n    };\n\n    this.routeToWall = () => {\n      if (this.state.routeToWall) {\n        this.setState({\n          routeToWall: false\n        });\n        return /*#__PURE__*/React.createElement(Redirect, {\n          push: true,\n          to: \"/Wall\",\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 319,\n            columnNumber: 15\n          }\n        });\n      }\n\n      return null;\n    };\n\n    this.getMeetingRouteStatus = () => {\n      this.setState({\n        routeToMeeting: true\n      });\n    };\n\n    this.routeToMeeting = () => {\n      if (this.state.routeToMeeting) {\n        this.setState({\n          routeToMeeting: false\n        });\n        return /*#__PURE__*/React.createElement(Redirect, {\n          push: true,\n          to: \"/Meeting\",\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 331,\n            columnNumber: 15\n          }\n        });\n      }\n\n      return null;\n    };\n\n    this.waitUntilPageIsLoaded = () => {\n      if (this.state.loadingUser || this.state.loadingLinkedUser) return /*#__PURE__*/React.createElement(\"div\", {\n        className: \"loader-element\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 339,\n          columnNumber: 9\n        }\n      }, /*#__PURE__*/React.createElement(\"h1\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 340,\n          columnNumber: 11\n        }\n      }, \"\\u05D0\\u05E0\\u05D0 \\u05D4\\u05DE\\u05EA\\u05DF... \"), /*#__PURE__*/React.createElement(Loader, {\n        color: \"#776078\",\n        width: \"300px\",\n        height: \"300px\",\n        type: \"Bars\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 341,\n          columnNumber: 11\n        }\n      }));else return /*#__PURE__*/React.createElement(Switch, {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 346,\n          columnNumber: 9\n        }\n      }, /*#__PURE__*/React.createElement(Route, {\n        path: \"/VideoPage\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 347,\n          columnNumber: 11\n        }\n      }, /*#__PURE__*/React.createElement(VideoPage, {\n        userName: this.state.userDetails.fName,\n        linkedName: this.state.linkedUserDetails.fName,\n        linkId: this.state.userDetails.link_user,\n        myLinkId: this.state.linkedUserDetails.link_user,\n        modifyVideoStream: this.modifyVideoStream,\n        directVid: this.state.directVid,\n        hostVid: this.state.hostVid,\n        room_id: this.state.roomId,\n        removeDocs: this.removeDocs,\n        modifyVideoNotAllowed: this.modifyVideoNotAllowed,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 348,\n          columnNumber: 13\n        }\n      })), \" \", /*#__PURE__*/React.createElement(Route, {\n        path: \"/Wall\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 362,\n          columnNumber: 11\n        }\n      }, /*#__PURE__*/React.createElement(\"div\", {\n        className: \"app-page\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 363,\n          columnNumber: 13\n        }\n      }, /*#__PURE__*/React.createElement(Profile, {\n        userDetails: this.state.userDetails,\n        profilePic: this.state.profilePicture,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 364,\n          columnNumber: 15\n        }\n      }), /*#__PURE__*/React.createElement(WallPost, {\n        userName: this.state.userDetails.fName + \" \" + this.state.userDetails.lName,\n        friendName: this.state.linkedUserDetails.fName + \" \" + this.state.linkedUserDetails.lName,\n        myProfilePic: this.state.profilePicture,\n        friendProfilePic: this.state.friendProfile,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 368,\n          columnNumber: 15\n        }\n      }), /*#__PURE__*/React.createElement(Profile, {\n        userDetails: this.state.linkedUserDetails,\n        profilePic: this.state.friendProfile,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 374,\n          columnNumber: 15\n        }\n      })), \" \", this.routeToVideo()), \" \", /*#__PURE__*/React.createElement(Route, {\n        path: \"/Home\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 381,\n          columnNumber: 11\n        }\n      }, /*#__PURE__*/React.createElement(HomePage, {\n        myDetails: this.state.userDetails,\n        linkedDetails: this.state.linkedUserDetails,\n        directVid: this.directVid,\n        newVideo: this.state.newVideo,\n        otherUserConnection: this.state.otherUserConnection,\n        otherUserLastOnline: this.state.otherUserLastOnline,\n        next_meeting: this.state.next_meeting,\n        getNextMeeting: this.getNextMeeting,\n        loadingNextMeeting: this.state.loadingNextMeeting,\n        routeToWall: this.getWallRouteStatus,\n        routeToMeeting: this.getMeetingRouteStatus,\n        myProfilePic: this.state.profilePicture,\n        friendProfilePic: this.state.friendProfile,\n        changeProfilePictue: this.changeProfilePictue,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 382,\n          columnNumber: 13\n        }\n      }), this.routeToWall(), this.routeToVideo(), this.routeToMeeting()), \" \", /*#__PURE__*/React.createElement(Route, {\n        path: \"/Meeting\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 402,\n          columnNumber: 11\n        }\n      }, /*#__PURE__*/React.createElement(Meeting, {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 403,\n          columnNumber: 13\n        }\n      }), this.routeToVideo()), \" \", /*#__PURE__*/React.createElement(Redirect, {\n        push: true,\n        to: \"/Home\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 406,\n          columnNumber: 11\n        }\n      }));\n    };\n\n    this.changePassword = () => {\n      this.setState({\n        pwdRender: true\n      });\n    };\n\n    this.closeChangePassword = () => {\n      this.setState({\n        pwdRender: false\n      });\n    };\n\n    this.renderPwd = () => {\n      if (this.state.pwdRender) return /*#__PURE__*/React.createElement(ChangePassword, {\n        parentCallback: this.closeChangePassword,\n        email: this.state.userDetails.email,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 421,\n          columnNumber: 15\n        }\n      });else return null;\n    };\n\n    this.state = {\n      userDetails: {\n        fName: \"\",\n        lName: \"\"\n      },\n      linkedUserDetails: {\n        fName: \"\",\n        lName: \"\"\n      },\n      isMounted: false,\n      loadingUser: true,\n      loadingLinkedUser: true,\n      next_meeting: null,\n      loadingNextMeeting: true,\n      active: false,\n      isOnVideo: false,\n      notAllowed: false,\n      roomId: \"\",\n      newVideo: \"\",\n      pageLoaded: false,\n      directVid: false,\n      hostVid: null,\n      routeToWall: false,\n      routeToMeeting: false,\n      otherUserConnection: false,\n      otherUserLastOnline: null,\n      pwdRender: false,\n      connectionKey: \"\",\n      link_user: \"\",\n      profilePicture: \"\",\n      friendProfile: \"\",\n      stopSnap: null,\n      zoom: Math.min(window.innerHeight / 620, window.innerWidth / 1536)\n    };\n    this.usersRef = firebase.firestore().collection('Users');\n    this.connectionRef = firebase.database().ref('.info/connected');\n    this.currUserUid = firebase.auth().currentUser.uid;\n    this.cloudRef = firebase.storage().ref();\n    this.myProfilePicturesRef = this.cloudRef.child('profile_pictures/' + firebase.auth().currentUser.uid);\n  }\n\n  componentWillUnmount() {\n    if (this.state.stopSnap) this.state.stopSnap();\n  }\n\n  componentDidMount() {\n    var webSiteWidth = 1280;\n    var webScale = window.screen.width / webSiteWidth;\n    document.querySelector('meta[name=\"viewport\"]').setAttribute('content', 'width=' + webSiteWidth + ', initial-scale=' + webScale + '');\n    window.addEventListener(\"resize\", this.resizeWin);\n    this.getUserName();\n    this.getProfilePictures();\n  }\n\n  componentDidUpdate(prevProp, prevState) {\n    if (this.state.userDetails.email !== prevState.userDetails.email) {\n      var mateDoc; //   if (typeof (this.state.userDetails.link_user) === 'undefined' || this.state.userDetails.link_user === \"\") {\n      //     alert(\"למשתמש זה אין חונך/חניך. אנא פנה למנהל המערכת עם הודעה זו.\");\n      //     firebase.auth().signOut();\n      //   }\n      //else {\n\n      this.getLinkedUser();\n      mateDoc = firebase.firestore().collection('Users').doc(this.state.userDetails.link_user);\n      mateDoc.get().then(doc => {\n        // if (!doc.exists || doc.data().link_user === \"\") {\n        //   alert(\"למשתמש זה אין חונך/חניך. אנא פנה למנהל המערכת עם הודעה זו.\");\n        //   firebase.auth().signOut();\n        // }\n        this.setState({\n          isMounted: true\n        });\n        this.updateConnection();\n        var unsubscribe = this.usersRef.doc(this.currUserUid).collection('Rooms').onSnapshot(snapshot => {\n          //listen to a room creation\n          snapshot.docChanges().forEach(change => {\n            if (this.state.otherUserConnection && change.type === \"added\" && change.doc.data() && !change.doc.data().answer) {\n              this.setState({\n                newVideo: \"added\"\n              });\n              this.setState({\n                roomId: change.doc.id\n              }, () => {\n                var con = window.confirm(`${this.state.linkedUserDetails.fName} הזמין אותך לשיחת וידאו. האם אתה מעוניין להצטרף?`);\n                if (con) this.directVid(false);\n              });\n            } else if (change.type === \"removed\") this.setState({\n              roomId: \"\",\n              newVideo: \"removed\"\n            });\n          });\n        });\n        this.setState({\n          stopSnap: unsubscribe\n        });\n      }).catch(e => console.log(e.name));\n    }\n  }\n\n  render() {\n    const activeTabStyle = {\n      fontWeight: \"bold\",\n      backgroundColor: \"#4CAF50\"\n    };\n    return /*#__PURE__*/React.createElement(\"div\", {\n      className: \"main-page-app\",\n      style: {\n        zoom: this.state.zoom\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 434,\n        columnNumber: 7\n      }\n    }, /*#__PURE__*/React.createElement(Router, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 435,\n        columnNumber: 9\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 436,\n        columnNumber: 11\n      }\n    }, /*#__PURE__*/React.createElement(\"nav\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 437,\n        columnNumber: 13\n      }\n    }, /*#__PURE__*/React.createElement(\"a\", {\n      href: \"https://www.bigbrothers.org.il/\",\n      onClick: e => this.hrefClick(e),\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 438,\n        columnNumber: 15\n      }\n    }, /*#__PURE__*/React.createElement(\"img\", {\n      src: logo,\n      alt: \"\",\n      className: \"MainLogo\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 441,\n        columnNumber: 17\n      }\n    })), /*#__PURE__*/React.createElement(\"ul\", {\n      className: \"nav\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 447,\n        columnNumber: 15\n      }\n    }, /*#__PURE__*/React.createElement(\"li\", {\n      className: \"nav-item \",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 448,\n        columnNumber: 17\n      }\n    }, /*#__PURE__*/React.createElement(NavLink, {\n      className: \"tab\",\n      to: \"/Home\",\n      activeStyle: activeTabStyle,\n      onClick: event => this.checkIfVideo(event),\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 449,\n        columnNumber: 19\n      }\n    }, \"\\u05D1\\u05D9\\u05EA\", \" \"), \" \"), \" \", /*#__PURE__*/React.createElement(\"li\", {\n      className: \"nav-item \",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 458,\n        columnNumber: 17\n      }\n    }, /*#__PURE__*/React.createElement(NavLink, {\n      className: \"tab\",\n      to: \"/Wall\",\n      activeStyle: activeTabStyle,\n      onClick: event => this.checkIfVideo(event),\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 459,\n        columnNumber: 19\n      }\n    }, \"\\u05E7\\u05D9\\u05E8\", \" \"), \" \"), \" \", /*#__PURE__*/React.createElement(\"li\", {\n      className: \"nav-item \",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 468,\n        columnNumber: 17\n      }\n    }, /*#__PURE__*/React.createElement(NavLink, {\n      className: \"tab\",\n      to: \"/VideoPage\",\n      activeStyle: activeTabStyle,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 469,\n        columnNumber: 19\n      }\n    }, \"\\u05E9\\u05D9\\u05D7\\u05EA \\u05D5\\u05D9\\u05D3\\u05D0\\u05D5\", \" \"), \" \"), \" \", /*#__PURE__*/React.createElement(\"li\", {\n      className: \"nav-item\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 477,\n        columnNumber: 17\n      }\n    }, /*#__PURE__*/React.createElement(NavLink, {\n      className: \"tab\",\n      to: \"/Meeting\",\n      activeStyle: activeTabStyle,\n      onClick: event => this.checkIfVideo(event),\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 478,\n        columnNumber: 19\n      }\n    }, \"\\u05E7\\u05D1\\u05D9\\u05E2\\u05EA \\u05E4\\u05D2\\u05D9\\u05E9\\u05D4\", \" \"), \" \"), \" \"), \" \", /*#__PURE__*/React.createElement(\"div\", {\n      className: \"navbar-options\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 488,\n        columnNumber: 15\n      }\n    }, /*#__PURE__*/React.createElement(\"button\", {\n      onClick: this.changePassword,\n      className: \"btn btn-outline-info change-pwd-btn\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 489,\n        columnNumber: 17\n      }\n    }, /*#__PURE__*/React.createElement(\"h6\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 489,\n        columnNumber: 103\n      }\n    }, \"\\u05E9\\u05D9\\u05E0\\u05D5\\u05D9 \\u05E1\\u05D9\\u05E1\\u05DE\\u05D0\")), /*#__PURE__*/React.createElement(\"h1\", {\n      className: \"username-home\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 490,\n        columnNumber: 17\n      }\n    }, \"\\u05E9\\u05DC\\u05D5\\u05DD, \", this.state.userDetails.fName + \" \" + this.state.userDetails.lName)), /*#__PURE__*/React.createElement(\"button\", {\n      className: \"btn btn-danger sign-out-btn\",\n      onClick: this.logout,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 492,\n        columnNumber: 15\n      }\n    }, \"\\u05D4\\u05EA\\u05E0\\u05EA\\u05E7\")), \" \", \" \", this.waitUntilPageIsLoaded()), \" \"), \" \", this.renderPwd());\n  }\n\n}\n\nexport default RacazPage;","map":{"version":3,"sources":["C:/Users/ahmad/Downloads/BigBrotherBigSisterIsrael-master/BigBrotherBigSisterIsrael-master/src/racazComponents/RacazPage.jsx"],"names":["React","Component","Meeting","WallPost","Profile","HomePage","VideoPage","ChangePassword","firebase","Loader","logo","BrowserRouter","Router","Switch","Route","NavLink","Redirect","RacazPage","constructor","props","logout","logOutConfirm","window","confirm","state","isMounted","updateDisconnection","auth","signOut","then","console","log","catch","error","resizeWin","e","setState","zoom","Math","min","innerHeight","innerWidth","getUserName","currentUser","currUserUid","firestore","collection","doc","get","uDetail","exists","alert","userDetails","data","loadingUser","name","setLinkedUser","linkedUserDetails","loadingLinkedUser","getLinkedUser","docRef","usersRef","link_user","getNextMeeting","meetingRef","where","Date","now","orderBy","limit","querySnap","empty","next_meeting","docs","loadingNextMeeting","checkIfVideo","event","isOnVideo","con","directVid","hostVid","preventDefault","notAllowed","modifyVideoStream","localSt","remoteSt","modifyVideoNotAllowed","updateConnection","myConnectionsRef","database","ref","id","lastOnlineRef","friendConnectionsRef","friendOnlineRef","connectionRef","on","snap","val","push","onDisconnect","remove","removeDocs","connectionKey","key","set","ServerValue","TIMESTAMP","otherUserConnection","otherUserLastOnline","querySnapshot","forEach","subSnap","subDoc","delete","child","getProfilePictures","myProfilePicturesRef","getDownloadURL","url","profilePicture","cloudRef","friendProfile","changeProfilePictue","hosting","hrefClick","routeToVideo","getWallRouteStatus","routeToWall","getMeetingRouteStatus","routeToMeeting","waitUntilPageIsLoaded","fName","roomId","lName","newVideo","changePassword","pwdRender","closeChangePassword","renderPwd","email","active","pageLoaded","stopSnap","uid","storage","componentWillUnmount","componentDidMount","webSiteWidth","webScale","screen","width","document","querySelector","setAttribute","addEventListener","componentDidUpdate","prevProp","prevState","mateDoc","unsubscribe","onSnapshot","snapshot","docChanges","change","type","answer","render","activeTabStyle","fontWeight","backgroundColor"],"mappings":"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","sourcesContent":["import React, { Component } from \"react\";\r\nimport Meeting from \"../navBarComponents/meetingComponents/Meeting\";\r\nimport WallPost from \"../navBarComponents/wallComponents/wall/WallPost\";\r\nimport Profile from \"../navBarComponents/wallComponents/profile/Profile\";\r\nimport HomePage from \"../navBarComponents/homeComponents/HomePage\";\r\nimport VideoPage from \"../navBarComponents/videoComponents/main/VideoPage\";\r\nimport ChangePassword from \"../mainPageComponents/ChangePassword\"\r\nimport \"./RacazPage.css\";\r\nimport \"bootstrap/dist/css/bootstrap.min.css\";\r\nimport firebase from \"../config/Firebase\"\r\nimport Loader from 'react-loader-spinner'\r\nimport logo from '../static_pictures/big_brothers_big_sisters.png'\r\nimport {\r\n  BrowserRouter as Router,\r\n  Switch,\r\n  Route,\r\n  NavLink,\r\n  Redirect,\r\n} from \"react-router-dom\";\r\n\r\nclass RacazPage extends Component {\r\n  constructor(props) {\r\n    super(props);\r\n    this.state = {\r\n      userDetails: {\r\n        fName: \"\",\r\n        lName: \"\"\r\n      },\r\n      linkedUserDetails: {\r\n        fName: \"\",\r\n        lName: \"\"\r\n      },\r\n      isMounted: false,\r\n      loadingUser: true,\r\n      loadingLinkedUser: true,\r\n      next_meeting: null,\r\n      loadingNextMeeting: true,\r\n      active: false,\r\n      isOnVideo: false,\r\n      notAllowed: false,\r\n      roomId: \"\",\r\n      newVideo: \"\",\r\n      pageLoaded: false,\r\n      directVid: false,\r\n      hostVid: null,\r\n      routeToWall: false,\r\n      routeToMeeting: false,\r\n      otherUserConnection: false,\r\n      otherUserLastOnline: null,\r\n      pwdRender: false,\r\n      connectionKey: \"\",\r\n      link_user: \"\",\r\n      profilePicture: \"\",\r\n      friendProfile: \"\",\r\n      stopSnap: null,\r\n      zoom: Math.min(window.innerHeight / 620, window.innerWidth / 1536)\r\n    };\r\n    this.usersRef = firebase.firestore().collection('Users');\r\n    this.connectionRef = firebase.database().ref('.info/connected');\r\n    this.currUserUid = firebase.auth().currentUser.uid;\r\n    this.cloudRef = firebase.storage().ref();\r\n    this.myProfilePicturesRef = this.cloudRef.child('profile_pictures/' + firebase.auth().currentUser.uid);\r\n  }\r\n\r\n  componentWillUnmount() {\r\n    if (this.state.stopSnap)\r\n      this.state.stopSnap();\r\n  }\r\n\r\n  logout = () => {\r\n    var logOutConfirm = window.confirm(\"האם אתה בטוח שברצונך להתנתק מהמערכת?\");\r\n    if (!logOutConfirm)\r\n      return;\r\n    if (this.state.isMounted)\r\n      this.updateDisconnection();\r\n    firebase.auth().signOut()\r\n      .then(() => {\r\n        console.log(\"Successful sign-out\")\r\n        // Sign-out successful.\r\n      })\r\n      .catch((error) => {\r\n        console.log(\"Sign-out error\")\r\n        // An error happened.\r\n      });\r\n  }\r\n\r\n  resizeWin = (e) => {\r\n    this.setState({\r\n      zoom: Math.min(window.innerHeight / 620, window.innerWidth / 1536)\r\n    });\r\n  };\r\n\r\n  getUserName = () => {\r\n    if (firebase.auth().currentUser === null)\r\n      return;\r\n    var currUserUid = firebase.firestore().collection('Users').doc(this.currUserUid);\r\n    currUserUid\r\n      .get()\r\n      .then((uDetail) => {\r\n        if (!uDetail.exists) {\r\n          alert(\"משתמש זה לא קיים יותר במערכת. אנא פנה למנהל.\");\r\n          firebase.auth().signOut();\r\n        }\r\n        else {\r\n          this.setState({ userDetails: uDetail.data() },\r\n            () => this.setState({ loadingUser: false }))\r\n        }\r\n      })\r\n      .catch((e) => console.log(e.name));\r\n  }\r\n\r\n  setLinkedUser = (doc) => {\r\n    this.setState({ linkedUserDetails: doc.data() });\r\n    this.setState({ loadingLinkedUser: false });\r\n  }\r\n\r\n  getLinkedUser = () => {\r\n    var docRef = this.usersRef.doc(this.state.userDetails.link_user);\r\n    docRef\r\n      .get()\r\n      .then((doc) => this.setLinkedUser(doc))\r\n      .catch((e) => console.log(e.name))\r\n  }\r\n\r\n  getNextMeeting = () => {\r\n    var meetingRef = this.usersRef.doc(this.currUserUid).collection('Meetings')\r\n    meetingRef\r\n      .where('timeStamp', \">=\", ((Date.now() / 1000)) - 900)\r\n      .orderBy(\"timeStamp\", \"asc\")\r\n      .limit(1)\r\n      .get()\r\n      .then(querySnap => {\r\n        if (!querySnap.empty)\r\n          this.setState({ next_meeting: querySnap.docs[0].data() });\r\n        else\r\n          this.setState({ next_meeting: null })\r\n      })\r\n      .then(() => this.setState({ loadingNextMeeting: false }))\r\n      .catch((e) => console.log(e.name))\r\n  }\r\n\r\n  checkIfVideo = (event) => {\r\n    if (this.state.isOnVideo) {\r\n      var con = window.confirm(\"האם אתה בטוח שברצונך לסיים את שיחת הוידאו?\");\r\n      if (con)\r\n        this.setState({ directVid: false, hostVid: null, isOnVideo: false });\r\n      else\r\n        event.preventDefault();\r\n    }\r\n    else if (this.state.notAllowed)\r\n      this.setState({ directVid: false, hostVid: null, isOnVideo: false });\r\n  }\r\n\r\n  modifyVideoStream = (localSt, remoteSt) => {\r\n    this.setState({ isOnVideo: true });\r\n  }\r\n\r\n  modifyVideoNotAllowed = () => {\r\n    this.setState({ notAllowed: true });\r\n  }\r\n\r\n  updateConnection = () => {\r\n    var myConnectionsRef = firebase.database().ref('users/' + this.state.userDetails.id + '/connected');\r\n    var lastOnlineRef = firebase.database().ref('users/' + this.state.userDetails.id + '/lastOnline');\r\n    var friendConnectionsRef = firebase.database().ref('users/' + this.state.linkedUserDetails.id + '/connected');\r\n    var friendOnlineRef = firebase.database().ref('users/' + this.state.linkedUserDetails.id + '/lastOnline');\r\n    this.connectionRef.on('value', (snap) => {\r\n      if (snap.val() === true) {\r\n        var con = myConnectionsRef.push();\r\n        con.onDisconnect().remove(this.removeDocs);\r\n        this.setState({ connectionKey: con.key });\r\n        con.set(true);\r\n        lastOnlineRef.onDisconnect().set(firebase.database.ServerValue.TIMESTAMP);\r\n      }\r\n    });\r\n    friendConnectionsRef.on('value', (snap) => {\r\n      if (snap.val() !== null)\r\n        this.setState({ otherUserConnection: true })\r\n      else\r\n        this.setState({ otherUserConnection: false })\r\n    });\r\n    friendOnlineRef.on('value', (snap) => {\r\n      this.setState({ otherUserLastOnline: snap.val() })\r\n    });\r\n  }\r\n\r\n  removeDocs = () => {\r\n    var ref = this.usersRef\r\n      .doc(this.state.userDetails.link_user)\r\n      .collection('Rooms');\r\n    ref\r\n      .get()\r\n      .then(querySnapshot => {\r\n        querySnapshot.forEach(doc => {\r\n          doc.ref.collection('first_participant')\r\n            .get()\r\n            .then(subSnap => {\r\n              subSnap.forEach(subDoc =>\r\n                subDoc.ref.delete())\r\n              doc.ref.collection('second_participant')\r\n                .get()\r\n                .then(subSnap =>\r\n                  subSnap.forEach(subDoc =>\r\n                    subDoc.ref.delete()))\r\n            })\r\n            .then(() => {\r\n              doc.ref.delete();\r\n            })\r\n        })\r\n      }).then(() => {\r\n        console.log(\"Docs has removed successfully\")\r\n      })\r\n      .catch(() => {\r\n        console.log(\"Problem in removing Doc\")\r\n      })\r\n  }\r\n\r\n  updateDisconnection = () => {\r\n    var myConnectionsRef = firebase.database().ref('users/' + this.state.userDetails.id + '/connected');\r\n    var lastOnlineRef = firebase.database().ref('users/' + this.state.userDetails.id + '/lastOnline');\r\n    myConnectionsRef.child('/' + this.state.connectionKey).remove();\r\n    lastOnlineRef.set(firebase.database.ServerValue.TIMESTAMP);\r\n  }\r\n\r\n  getProfilePictures = () => {\r\n    this.myProfilePicturesRef.getDownloadURL()\r\n      .then(url => this.setState({ profilePicture: url }))\r\n      .catch((e) => console.log(e.name));\r\n    this.usersRef.doc(this.currUserUid).get()\r\n      .then(doc => this.setState({ link_user: doc.data().link_user },\r\n        () => {\r\n\r\n          this.cloudRef.child('profile_pictures/' + this.state.link_user)\r\n            .getDownloadURL()\r\n            .then((url) => this.setState({ friendProfile: url }))\r\n            .catch((e) => console.log(e.name));\r\n        }))\r\n      .catch((e) => console.log(e.name));\r\n  }\r\n\r\n  changeProfilePictue = (url) => {\r\n    this.setState({ profilePicture: url });\r\n  }\r\n\r\n  componentDidMount() {\r\n    var webSiteWidth = 1280;\r\n    var webScale = window.screen.width / webSiteWidth\r\n    document.querySelector('meta[name=\"viewport\"]').setAttribute('content', 'width=' + webSiteWidth + ', initial-scale=' + webScale + '');\r\n\r\n    window.addEventListener(\"resize\", this.resizeWin);\r\n    this.getUserName();\r\n    this.getProfilePictures();\r\n  }\r\n\r\n  componentDidUpdate(prevProp, prevState) {\r\n    if (this.state.userDetails.email !== prevState.userDetails.email) {\r\n      var mateDoc;\r\n    //   if (typeof (this.state.userDetails.link_user) === 'undefined' || this.state.userDetails.link_user === \"\") {\r\n    //     alert(\"למשתמש זה אין חונך/חניך. אנא פנה למנהל המערכת עם הודעה זו.\");\r\n    //     firebase.auth().signOut();\r\n    //   }\r\n      //else {\r\n        this.getLinkedUser();\r\n        mateDoc = firebase.firestore().collection('Users').doc(this.state.userDetails.link_user);\r\n        mateDoc.get()\r\n          .then((doc) => {\r\n            // if (!doc.exists || doc.data().link_user === \"\") {\r\n            //   alert(\"למשתמש זה אין חונך/חניך. אנא פנה למנהל המערכת עם הודעה זו.\");\r\n            //   firebase.auth().signOut();\r\n            // }\r\n           \r\n              this.setState({ isMounted: true });\r\n              this.updateConnection();\r\n              var unsubscribe = this.usersRef.doc(this.currUserUid).collection('Rooms').onSnapshot(snapshot => { //listen to a room creation\r\n                snapshot.docChanges().forEach(change => {\r\n                  if (this.state.otherUserConnection && change.type === \"added\" && change.doc.data() && !change.doc.data().answer) {\r\n                    this.setState({ newVideo: \"added\" });\r\n                    this.setState({ roomId: change.doc.id }, () => {\r\n                      var con = window.confirm(`${this.state.linkedUserDetails.fName} הזמין אותך לשיחת וידאו. האם אתה מעוניין להצטרף?`)\r\n                      if (con)\r\n                        this.directVid(false);\r\n                    });\r\n                  }\r\n                  else if (change.type === \"removed\")\r\n                    this.setState({ roomId: \"\", newVideo: \"removed\" });\r\n                });\r\n              });\r\n              this.setState({ stopSnap: unsubscribe });\r\n            \r\n          })\r\n          .catch((e) => console.log(e.name));\r\n    \r\n    }\r\n  }\r\n\r\n  directVid = (hosting) => {\r\n    this.setState({ directVid: true, hostVid: hosting })\r\n  }\r\n\r\n  hrefClick = (e) => {\r\n    var con = window.confirm(\"האם אתה בטוח שברצונך לעזוב את האתר?\");\r\n    if (!con)\r\n      e.preventDefault();\r\n  }\r\n\r\n  routeToVideo = () => {\r\n    if (this.state.directVid)\r\n      return (<Redirect push to=\"/VideoPage\" ></Redirect>);\r\n    return null;\r\n  }\r\n\r\n  getWallRouteStatus = () => {\r\n    this.setState({ routeToWall: true })\r\n  }\r\n\r\n  routeToWall = () => {\r\n    if (this.state.routeToWall) {\r\n      this.setState({ routeToWall: false })\r\n      return (<Redirect push to=\"/Wall\" ></Redirect>);\r\n    }\r\n    return null;\r\n  }\r\n\r\n  getMeetingRouteStatus = () => {\r\n    this.setState({ routeToMeeting: true })\r\n  }\r\n\r\n  routeToMeeting = () => {\r\n    if (this.state.routeToMeeting) {\r\n      this.setState({ routeToMeeting: false })\r\n      return (<Redirect push to=\"/Meeting\" ></Redirect>);\r\n    }\r\n    return null;\r\n  }\r\n\r\n  waitUntilPageIsLoaded = () => {\r\n    if (this.state.loadingUser || this.state.loadingLinkedUser)\r\n      return (\r\n        <div className=\"loader-element\">\r\n          <h1>אנא המתן... </h1>\r\n          <Loader color=\"#776078\" width=\"300px\" height=\"300px\" type=\"Bars\" />\r\n        </div>\r\n      );\r\n    else\r\n      return (\r\n        <Switch>\r\n          <Route path=\"/VideoPage\">\r\n            <VideoPage\r\n              userName={this.state.userDetails.fName}\r\n              linkedName={this.state.linkedUserDetails.fName}\r\n              linkId={this.state.userDetails.link_user}\r\n              myLinkId={this.state.linkedUserDetails.link_user}\r\n              modifyVideoStream={this.modifyVideoStream}\r\n              directVid={this.state.directVid}\r\n              hostVid={this.state.hostVid}\r\n              room_id={this.state.roomId}\r\n              removeDocs={this.removeDocs}\r\n              modifyVideoNotAllowed={this.modifyVideoNotAllowed}\r\n            />\r\n\r\n          </Route>{\" \"}\r\n          <Route path=\"/Wall\">\r\n            <div className=\"app-page\">\r\n              <Profile\r\n                userDetails={this.state.userDetails}\r\n                profilePic={this.state.profilePicture}\r\n              />\r\n              <WallPost\r\n                userName={this.state.userDetails.fName + \" \" + this.state.userDetails.lName}\r\n                friendName={this.state.linkedUserDetails.fName + \" \" + this.state.linkedUserDetails.lName}\r\n                myProfilePic={this.state.profilePicture}\r\n                friendProfilePic={this.state.friendProfile}\r\n              />\r\n              <Profile\r\n                userDetails={this.state.linkedUserDetails}\r\n                profilePic={this.state.friendProfile}\r\n              />\r\n            </div>{\" \"}\r\n            {this.routeToVideo()}\r\n          </Route>{\" \"}\r\n          <Route path=\"/Home\">\r\n            <HomePage\r\n              myDetails={this.state.userDetails}\r\n              linkedDetails={this.state.linkedUserDetails}\r\n              directVid={this.directVid}\r\n              newVideo={this.state.newVideo}\r\n              otherUserConnection={this.state.otherUserConnection}\r\n              otherUserLastOnline={this.state.otherUserLastOnline}\r\n              next_meeting={this.state.next_meeting}\r\n              getNextMeeting={this.getNextMeeting}\r\n              loadingNextMeeting={this.state.loadingNextMeeting}\r\n              routeToWall={this.getWallRouteStatus}\r\n              routeToMeeting={this.getMeetingRouteStatus}\r\n              myProfilePic={this.state.profilePicture}\r\n              friendProfilePic={this.state.friendProfile}\r\n              changeProfilePictue={this.changeProfilePictue}\r\n            />\r\n            {this.routeToWall()}\r\n            {this.routeToVideo()}\r\n            {this.routeToMeeting()}\r\n          </Route>{\" \"}\r\n          <Route path=\"/Meeting\">\r\n            <Meeting />\r\n            {this.routeToVideo()}\r\n          </Route>{\" \"}\r\n          <Redirect push to=\"/Home\" ></Redirect>\r\n        </Switch>\r\n      );\r\n  }\r\n\r\n  changePassword = () => {\r\n    this.setState({ pwdRender: true })\r\n  }\r\n\r\n  closeChangePassword = () => {\r\n    this.setState({ pwdRender: false })\r\n  }\r\n\r\n  renderPwd = () => {\r\n    if (this.state.pwdRender)\r\n      return (<ChangePassword parentCallback={this.closeChangePassword} email={this.state.userDetails.email} />);\r\n    else\r\n      return null;\r\n  }\r\n\r\n  render() {\r\n\r\n    const activeTabStyle = {\r\n      fontWeight: \"bold\",\r\n      backgroundColor: \"#4CAF50\",\r\n    };\r\n\r\n    return (\r\n      <div className=\"main-page-app\" style={{ zoom: this.state.zoom }}>\r\n        <Router>\r\n          <div>\r\n            <nav>\r\n              <a\r\n                href=\"https://www.bigbrothers.org.il/\"\r\n                onClick={(e) => this.hrefClick(e)}>\r\n                <img\r\n                  src={logo}\r\n                  alt=\"\"\r\n                  className=\"MainLogo\"\r\n                />\r\n              </a>\r\n              <ul className=\"nav\">\r\n                <li className=\"nav-item \">\r\n                  <NavLink\r\n                    className=\"tab\"\r\n                    to=\"/Home\"\r\n                    activeStyle={activeTabStyle}\r\n                    onClick={(event) => this.checkIfVideo(event)}\r\n                  >\r\n                    בית{\" \"}\r\n                  </NavLink>{\" \"}\r\n                </li>{\" \"}\r\n                <li className=\"nav-item \">\r\n                  <NavLink\r\n                    className=\"tab\"\r\n                    to=\"/Wall\"\r\n                    activeStyle={activeTabStyle}\r\n                    onClick={(event) => this.checkIfVideo(event)}\r\n                  >\r\n                    קיר{\" \"}\r\n                  </NavLink>{\" \"}\r\n                </li>{\" \"}\r\n                <li className=\"nav-item \">\r\n                  <NavLink\r\n                    className=\"tab\"\r\n                    to=\"/VideoPage\"\r\n                    activeStyle={activeTabStyle}\r\n                  >\r\n                    שיחת וידאו{\" \"}\r\n                  </NavLink>{\" \"}\r\n                </li>{\" \"}\r\n                <li className=\"nav-item\">\r\n                  <NavLink\r\n                    className=\"tab\"\r\n                    to=\"/Meeting\"\r\n                    activeStyle={activeTabStyle}\r\n                    onClick={(event) => this.checkIfVideo(event)}\r\n                  >\r\n                    קביעת פגישה{\" \"}\r\n                  </NavLink>{\" \"}\r\n                </li>{\" \"}\r\n              </ul>{\" \"}\r\n              <div className=\"navbar-options\">\r\n                <button onClick={this.changePassword} className=\"btn btn-outline-info change-pwd-btn\"><h6>שינוי סיסמא</h6></button>\r\n                <h1 className=\"username-home\">שלום, {this.state.userDetails.fName + \" \" + this.state.userDetails.lName}</h1>\r\n              </div>\r\n              <button className=\"btn btn-danger sign-out-btn\" onClick={this.logout}>התנתק</button>\r\n            </nav>{\" \"}\r\n            {/* A <Switch> looks through its children <Route>s and\r\n                                                        renders the first one that matches the current URL. */}{\" \"}\r\n            {this.waitUntilPageIsLoaded()}\r\n          </div>{\" \"}\r\n        </Router>{\" \"}\r\n        {this.renderPwd()}\r\n      </div>\r\n    );\r\n  }\r\n}\r\n\r\nexport default RacazPage;"]},"metadata":{},"sourceType":"module"}