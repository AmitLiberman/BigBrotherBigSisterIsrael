{"ast":null,"code":"import _toConsumableArray from\"C:\\\\Users\\\\ahmad\\\\Downloads\\\\BigBrotherBigSisterIsrael-master\\\\BigBrotherBigSisterIsrael-master\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/toConsumableArray\";import _classCallCheck from\"C:\\\\Users\\\\ahmad\\\\Downloads\\\\BigBrotherBigSisterIsrael-master\\\\BigBrotherBigSisterIsrael-master\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/classCallCheck\";import _createClass from\"C:\\\\Users\\\\ahmad\\\\Downloads\\\\BigBrotherBigSisterIsrael-master\\\\BigBrotherBigSisterIsrael-master\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/createClass\";import _inherits from\"C:\\\\Users\\\\ahmad\\\\Downloads\\\\BigBrotherBigSisterIsrael-master\\\\BigBrotherBigSisterIsrael-master\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/inherits\";import _createSuper from\"C:\\\\Users\\\\ahmad\\\\Downloads\\\\BigBrotherBigSisterIsrael-master\\\\BigBrotherBigSisterIsrael-master\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/createSuper\";import React,{Component}from\"react\";import\"./Meeting.css\";import firebase from\"../../config/Firebase\";import MeetingList from\"./MeetingList\";var Meeting=/*#__PURE__*/function(_Component){_inherits(Meeting,_Component);var _super=_createSuper(Meeting);function Meeting(props){var _this;_classCallCheck(this,Meeting);_this=_super.call(this,props);_this.getMeetings=function(){var newMeetingObj;var futureMeetings=_this.myMeetingsRef.where('timeStamp',\">=\",Date.now()/1000-7200).orderBy(\"timeStamp\",\"desc\");futureMeetings.get().then(function(querySnap){_this.setState({lastMeetingVisible:querySnap.docs[querySnap.docs.length-1],futureLength:querySnap.docs.length},function(){if(querySnap.empty)_this.setState({lastMeetingVisible:{timeStamp:Date.now()/1000-7200}});else if(typeof _this.state.lastMeetingVisible==='undefined')_this.setState({loadedAll:true});});querySnap.forEach(function(doc){newMeetingObj={};Object.assign(newMeetingObj,doc.data());newMeetingObj.doc_id=doc.id;_this.setState({meetings:[].concat(_toConsumableArray(_this.state.meetings),[newMeetingObj])});});}).then(function(){return _this.setState({loadingFromFirebase:false});}).catch(function(e){return console.log(e.name);});};_this.updateTableAfterDelete=function(meetingsArr){_this.setState({meetings:_toConsumableArray(meetingsArr)});};_this.loadPrev=function(){if(typeof _this.state.lastMeetingVisible==='undefined')return;var startFrom;if(typeof _this.state.lastMeetingVisible.timeStamp==='undefined')startFrom=_this.state.lastMeetingVisible.data().timeStamp;else startFrom=_this.state.lastMeetingVisible.timeStamp;_this.setState({loadingPastMeetings:true});var newMeetingObj;_this.myMeetingsRef.orderBy(\"timeStamp\",\"desc\").startAfter(startFrom).limit(5).get().then(function(querySnap){if(querySnap.docs.length<5)_this.setState({loadedAll:true});if(querySnap.docs.length===0)return;_this.setState({lastMeetingVisible:querySnap.docs[querySnap.docs.length-1]});querySnap.forEach(function(doc){newMeetingObj={};Object.assign(newMeetingObj,doc.data());newMeetingObj.doc_id=doc.id;_this.setState({meetings:[].concat(_toConsumableArray(_this.state.meetings),[newMeetingObj])});});}).then(function(){return _this.setState({loadingPastMeetings:false});}).catch(function(e){return console.log(e.name);});};_this.getTable=function(){return/*#__PURE__*/React.createElement(MeetingList,{className:\"meeting-list\",meetingsArr:_this.state.meetings,loading:_this.state.loadingFromFirebase,myUser:_this.myMeetingsRef,linkUser:_this.mateMeetingsRef,updateRef:_this.updateTableAfterDelete,loadPrev:_this.loadPrev,loadedAll:_this.state.loadedAll,futureLength:_this.state.futureLength,loadingPastMeetings:_this.state.loadingPastMeetings});};_this.handleSubmit=function(event){event.preventDefault();var isSure;if(!_this.state.scheduled){isSure=window.confirm(\"האם ברצונך לקבוע פגישה:\\nבתאריך: \"+_this.state.date+\"\\nבשעה: \"+_this.state.time+\"\\nבמיקום: \"+_this.state.place);}else isSure=window.confirm(\"האם ברצונך לקבוע 13 פגישות קבועות לשלושת החודשים הקרובים:\\nהחל מתאריך: \"+_this.state.date+\"\\nבשעה: \"+_this.state.time+\"\\nבמיקום: \"+_this.state.place);if(isSure){var amount_of_meetings=_this.state.scheduled?13:1;var dates=[],newMeetings=[],newMeetingObj=[];var _loop=function _loop(i){nextDate=new Date(Date.parse(_this.state.date)+7*24*60*60*1000*i);dates.push(nextDate.getFullYear()+\"-\"+(nextDate.getMonth()+1)+\"-\"+nextDate.getDate());time_stamp=Date.parse(dates[i]+\" \"+_this.state.time)/1000;newMeetings.push({date:dates[i],timeStamp:time_stamp,time:_this.state.time,place:_this.state.place,description:_this.state.description});newMeetingObj.push({});_this.myMeetingsRef.add(newMeetings[i]).then(function(docRef){_this.newDocId=docRef.id;_this.mateMeetingsRef.doc(docRef.id).set(newMeetings[i]);}).then(function(){if(!_this.state.scheduled&&_this.state.date!==\"\"){alert(\"נקבעה פגישה בתאריך: \"+_this.state.date+\"\\nבשעה: \"+_this.state.time+\"\\nבמיקום: \"+_this.state.place);}else if(i===0)alert(\"נקבעו 13 פגישות קבועות לשלושת החודשים הקרובים.\");Object.assign(newMeetingObj[i],newMeetings[i]);newMeetingObj[i].doc_id=_this.newDocId;var d=[].concat(_this.state.meetings).concat(newMeetingObj[i]).sort(function(a,b){return _this.sortFunc(a,b);});_this.setState({meetings:_toConsumableArray(d),date:\"\",time:\"\",place:\"\",description:\"\",scheduled:false});}).catch(function(e){return console.log(e.name);});};for(var i=0;i<amount_of_meetings;i++){var nextDate;var time_stamp;_loop(i);}}};_this.sortFunc=function(a,b){if(a.timeStamp>b.timeStamp)return-1;if(a.timeStamp<b.timeStamp)return 1;return 0;};_this.state={meetings:[],date:\"\",time:\"\",place:\"\",description:\"\",loadingFromFirebase:true,lastMeetingVisible:null,loadedAll:false,futureLength:0,loadingPastMeetings:false,scheduled:false};_this.newDocId=\"\";_this.myMeetingsRef=firebase.firestore().collection('Users').doc(firebase.auth().currentUser.uid).collection('Meetings');firebase.firestore().collection('Users').doc(firebase.auth().currentUser.uid).get().then(function(doc){_this.linkUser=doc.data().link_user;_this.mateMeetingsRef=firebase.firestore().collection('Users').doc(_this.linkUser).collection('Meetings');}).catch(function(e){return console.log(e.name);});return _this;}_createClass(Meeting,[{key:\"componentDidMount\",value:function componentDidMount(){this.getMeetings();}},{key:\"render\",value:function render(){var _this2=this;return/*#__PURE__*/React.createElement(\"div\",{className:\"main-background\"},/*#__PURE__*/React.createElement(\"form\",{className:\"meeting-form\",onSubmit:this.handleSubmit},/*#__PURE__*/React.createElement(\"br\",null),/*#__PURE__*/React.createElement(\"div\",{className:\"form-group\"},/*#__PURE__*/React.createElement(\"h1\",{className:\"meeting-title\"},/*#__PURE__*/React.createElement(\"u\",null,\"\\u05E7\\u05D1\\u05D9\\u05E2\\u05EA \\u05E4\\u05D2\\u05D9\\u05E9\\u05D4\")),/*#__PURE__*/React.createElement(\"label\",{className:\"fLabels\",style:{float:\"right\"},htmlFor:\"date\"},\"\\u05EA\\u05D0\\u05E8\\u05D9\\u05DA \\u05D4\\u05E4\\u05D2\\u05D9\\u05E9\\u05D4\"),/*#__PURE__*/React.createElement(\"input\",{onChange:function onChange(e){return _this2.setState({date:e.target.value});},type:\"date\",className:\"form-control\",id:\"date\",placeholder:\"\\u05EA\\u05D0\\u05E8\\u05D9\\u05DA \\u05D4\\u05E4\\u05D2\\u05D9\\u05E9\\u05D4\",value:this.state.date,required:true})),/*#__PURE__*/React.createElement(\"div\",{className:\"form-group\"},/*#__PURE__*/React.createElement(\"label\",{className:\"fLabels\",style:{float:\"right\"},htmlFor:\"hour\"},\"\\u05E9\\u05E2\\u05EA \\u05D4\\u05E4\\u05D2\\u05D9\\u05E9\\u05D4\"),/*#__PURE__*/React.createElement(\"input\",{onChange:function onChange(e){return _this2.setState({time:e.target.value});},type:\"time\",className:\"form-control\",id:\"hour\",placeholder:\"\\u05E9\\u05E2\\u05EA \\u05D4\\u05E4\\u05D2\\u05D9\\u05E9\\u05D4\",value:this.state.time,required:true})),/*#__PURE__*/React.createElement(\"div\",{className:\"form-group\"},/*#__PURE__*/React.createElement(\"label\",{className:\"fLabels\",style:{float:\"right\"},htmlFor:\"place\"},\"\\u05DE\\u05D9\\u05E7\\u05D5\\u05DD \\u05D4\\u05E4\\u05D2\\u05D9\\u05E9\\u05D4\"),/*#__PURE__*/React.createElement(\"input\",{onChange:function onChange(e){return _this2.setState({place:e.target.value});},type:\"text\",className:\"form-control\",id:\"place\",placeholder:\"\\u05DE\\u05D9\\u05E7\\u05D5\\u05DD \\u05D4\\u05E4\\u05D2\\u05D9\\u05E9\\u05D4\",value:this.state.place,required:true})),/*#__PURE__*/React.createElement(\"div\",{className:\"form-group\"},/*#__PURE__*/React.createElement(\"label\",{className:\"fLabels\",style:{float:\"right\"},htmlFor:\"description\"},\"\\u05EA\\u05D9\\u05D0\\u05D5\\u05E8\"),/*#__PURE__*/React.createElement(\"input\",{onChange:function onChange(e){return _this2.setState({description:e.target.value});},type:\"text\",className:\"form-control\",id:\"description\",value:this.state.description,placeholder:\"\\u05EA\\u05D9\\u05D0\\u05D5\\u05E8\"})),/*#__PURE__*/React.createElement(\"div\",{className:\"form-group\"},/*#__PURE__*/React.createElement(\"input\",{type:\"checkbox\",className:\"form-check-input w-25\",id:\"scheduledMeeting\",checked:this.state.scheduled,onChange:function onChange(e){return _this2.setState({scheduled:!_this2.state.scheduled});}}),/*#__PURE__*/React.createElement(\"label\",{className:\"form-check-label check-meeting-lbl w-75\",style:{float:\"right\"},htmlFor:\"description\"},\"\\u05E4\\u05D2\\u05D9\\u05E9\\u05D5\\u05EA \\u05E7\\u05D1\\u05D5\\u05E2\\u05D5\\u05EA - \\u05DC\\u05E9\\u05DC\\u05D5\\u05E9\\u05EA \\u05D4\\u05D7\\u05D5\\u05D3\\u05E9\\u05D9\\u05DD \\u05D4\\u05E7\\u05E8\\u05D5\\u05D1\\u05D9\\u05DD\")),/*#__PURE__*/React.createElement(\"br\",null),/*#__PURE__*/React.createElement(\"button\",{className:\"btn btn-success setup-meeting-btn\",style:{float:\"right\",marginRight:\"700px\"}},\"\\u05E7\\u05D1\\u05E2 \\u05E4\\u05D2\\u05D9\\u05E9\\u05D4!\",\" \")),this.getTable());}}]);return Meeting;}(Component);export default Meeting;","map":{"version":3,"sources":["C:/Users/ahmad/Downloads/BigBrotherBigSisterIsrael-master/BigBrotherBigSisterIsrael-master/src/navBarComponents/meetingComponents/Meeting.jsx"],"names":["React","Component","firebase","MeetingList","Meeting","props","getMeetings","newMeetingObj","futureMeetings","myMeetingsRef","where","Date","now","orderBy","get","then","querySnap","setState","lastMeetingVisible","docs","length","futureLength","empty","timeStamp","state","loadedAll","forEach","doc","Object","assign","data","doc_id","id","meetings","loadingFromFirebase","catch","e","console","log","name","updateTableAfterDelete","meetingsArr","loadPrev","startFrom","loadingPastMeetings","startAfter","limit","getTable","mateMeetingsRef","handleSubmit","event","preventDefault","isSure","scheduled","window","confirm","date","time","place","amount_of_meetings","dates","newMeetings","i","nextDate","parse","push","getFullYear","getMonth","getDate","time_stamp","description","add","docRef","newDocId","set","alert","d","concat","sort","a","b","sortFunc","firestore","collection","auth","currentUser","uid","linkUser","link_user","float","target","value","marginRight"],"mappings":"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","sourcesContent":["import React, { Component } from \"react\";\r\nimport \"./Meeting.css\";\r\nimport firebase from \"../../config/Firebase\"\r\nimport MeetingList from \"./MeetingList\"\r\n\r\nclass Meeting extends Component {\r\n  constructor(props) {\r\n    super(props);\r\n    this.state = {\r\n      meetings: [],\r\n      date: \"\",\r\n      time: \"\",\r\n      place: \"\",\r\n      description: \"\",\r\n      loadingFromFirebase: true,\r\n      lastMeetingVisible: null,\r\n      loadedAll: false,\r\n      futureLength: 0,\r\n      loadingPastMeetings: false,\r\n      scheduled: false\r\n    };\r\n    this.newDocId = \"\";\r\n    this.myMeetingsRef = firebase.firestore().collection('Users').doc(firebase.auth().currentUser.uid).collection('Meetings');\r\n    firebase.firestore().collection('Users').doc(firebase.auth().currentUser.uid).get()\r\n      .then((doc) => {\r\n        this.linkUser = doc.data().link_user;\r\n        this.mateMeetingsRef = firebase.firestore().collection('Users').doc(this.linkUser).collection('Meetings');\r\n      })\r\n      .catch((e) => console.log(e.name))\r\n  }\r\n\r\n  getMeetings = () => {\r\n    var newMeetingObj;\r\n    var futureMeetings = this.myMeetingsRef\r\n      .where('timeStamp', \">=\", ((Date.now() / 1000) - 7200))\r\n      .orderBy(\"timeStamp\", \"desc\")\r\n\r\n    futureMeetings\r\n      .get()\r\n      .then((querySnap) => {\r\n        this.setState({ lastMeetingVisible: querySnap.docs[querySnap.docs.length - 1], futureLength: querySnap.docs.length }, () => {\r\n          if (querySnap.empty)\r\n            this.setState({ lastMeetingVisible: { timeStamp: ((Date.now() / 1000) - 7200) } })\r\n          else if (typeof (this.state.lastMeetingVisible) === 'undefined')\r\n            this.setState({ loadedAll: true })\r\n        })\r\n        querySnap.forEach((doc) => {\r\n          newMeetingObj = {};\r\n          Object.assign(newMeetingObj, doc.data());\r\n          newMeetingObj.doc_id = doc.id;\r\n          this.setState({ meetings: [...this.state.meetings, newMeetingObj] })\r\n        })\r\n      })\r\n      .then(() => this.setState({ loadingFromFirebase: false }))\r\n      .catch((e) => console.log(e.name))\r\n  }\r\n\r\n  componentDidMount() {\r\n    this.getMeetings();\r\n  }\r\n\r\n  updateTableAfterDelete = (meetingsArr) => {\r\n    this.setState({ meetings: [...meetingsArr] });\r\n  }\r\n\r\n  loadPrev = () => {\r\n    if (typeof (this.state.lastMeetingVisible) === 'undefined')\r\n      return;\r\n    var startFrom;\r\n    if (typeof (this.state.lastMeetingVisible.timeStamp) === 'undefined')\r\n      startFrom = this.state.lastMeetingVisible.data().timeStamp;\r\n    else\r\n      startFrom = this.state.lastMeetingVisible.timeStamp;\r\n    this.setState({ loadingPastMeetings: true });\r\n    var newMeetingObj;\r\n    this.myMeetingsRef\r\n      .orderBy(\"timeStamp\", \"desc\")\r\n      .startAfter(startFrom)\r\n      .limit(5)\r\n      .get()\r\n      .then((querySnap) => {\r\n        if (querySnap.docs.length < 5)\r\n          this.setState({ loadedAll: true })\r\n        if (querySnap.docs.length === 0)\r\n          return;\r\n        this.setState({ lastMeetingVisible: querySnap.docs[querySnap.docs.length - 1] })\r\n        querySnap.forEach((doc) => {\r\n          newMeetingObj = {};\r\n          Object.assign(newMeetingObj, doc.data());\r\n          newMeetingObj.doc_id = doc.id;\r\n          this.setState({ meetings: [...this.state.meetings, newMeetingObj] });\r\n        })\r\n      })\r\n      .then(() => this.setState({ loadingPastMeetings: false }))\r\n      .catch((e) => console.log(e.name))\r\n  }\r\n\r\n  getTable = () => {\r\n    return <MeetingList\r\n      className=\"meeting-list\"\r\n      meetingsArr={this.state.meetings}\r\n      loading={this.state.loadingFromFirebase}\r\n      myUser={this.myMeetingsRef}\r\n      linkUser={this.mateMeetingsRef}\r\n      updateRef={this.updateTableAfterDelete}\r\n      loadPrev={this.loadPrev}\r\n      loadedAll={this.state.loadedAll}\r\n      futureLength={this.state.futureLength}\r\n      loadingPastMeetings={this.state.loadingPastMeetings}\r\n    />\r\n  }\r\n\r\n  handleSubmit = (event) => {\r\n    event.preventDefault();\r\n    var isSure;\r\n    if (!this.state.scheduled) {\r\n      isSure = window.confirm(\r\n        \"האם ברצונך לקבוע פגישה:\\nבתאריך: \" +\r\n        this.state.date +\r\n        \"\\nבשעה: \" +\r\n        this.state.time +\r\n        \"\\nבמיקום: \" +\r\n        this.state.place\r\n      );\r\n    }\r\n    else\r\n      isSure = window.confirm(\r\n        \"האם ברצונך לקבוע 13 פגישות קבועות לשלושת החודשים הקרובים:\\nהחל מתאריך: \" +\r\n        this.state.date +\r\n        \"\\nבשעה: \" +\r\n        this.state.time +\r\n        \"\\nבמיקום: \" +\r\n        this.state.place\r\n      );\r\n    if (isSure) {\r\n      var amount_of_meetings = this.state.scheduled ? 13 : 1;\r\n      var dates = [], newMeetings = [], newMeetingObj = [];\r\n      for (let i = 0; i < amount_of_meetings; i++) {\r\n        var nextDate = (new Date(Date.parse(this.state.date) + (7 * 24 * 60 * 60 * 1000) * i));\r\n        dates.push(nextDate.getFullYear() + \"-\" + (nextDate.getMonth() + 1) + \"-\" + nextDate.getDate());\r\n        var time_stamp = (((Date.parse(dates[i] + \" \" + this.state.time)) / 1000));\r\n        newMeetings.push({\r\n          date: dates[i],\r\n          timeStamp: time_stamp,\r\n          time: this.state.time,\r\n          place: this.state.place,\r\n          description: this.state.description\r\n        })\r\n        newMeetingObj.push({});\r\n        this.myMeetingsRef.add(newMeetings[i])\r\n          .then((docRef) => {\r\n            this.newDocId = docRef.id;\r\n            this.mateMeetingsRef.doc(docRef.id).set(newMeetings[i]);\r\n          })\r\n          .then(() => {\r\n            if (!this.state.scheduled && this.state.date !== \"\") {\r\n              alert(\r\n                \"נקבעה פגישה בתאריך: \" +\r\n                this.state.date +\r\n                \"\\nבשעה: \" +\r\n                this.state.time +\r\n                \"\\nבמיקום: \" +\r\n                this.state.place\r\n              );\r\n            }\r\n            else if (i === 0)\r\n              alert(\r\n                \"נקבעו 13 פגישות קבועות לשלושת החודשים הקרובים.\"\r\n              );\r\n            Object.assign(newMeetingObj[i], newMeetings[i]);\r\n            newMeetingObj[i].doc_id = this.newDocId;\r\n            const d = [].concat(this.state.meetings).concat(newMeetingObj[i]).sort((a, b) => this.sortFunc(a, b));\r\n            this.setState({\r\n              meetings: [...d],\r\n              date: \"\", time: \"\", place: \"\", description: \"\", scheduled: false\r\n            });\r\n          })\r\n          .catch((e) => console.log(e.name));\r\n      }\r\n    }\r\n  }\r\n\r\n  sortFunc = (a, b) => {\r\n    if (a.timeStamp > b.timeStamp)\r\n      return -1;\r\n    if (a.timeStamp < b.timeStamp)\r\n      return 1;\r\n    return 0;\r\n  }\r\n\r\n  render() {\r\n    return (\r\n      <div className=\"main-background\" >\r\n        <form className=\"meeting-form\" onSubmit={this.handleSubmit}>\r\n          <br />\r\n          <div className=\"form-group\">\r\n            <h1 className=\"meeting-title\"><u>קביעת פגישה</u></h1>\r\n\r\n            <label\r\n              className=\"fLabels\"\r\n              style={{ float: \"right\" }}\r\n              htmlFor=\"date\"\r\n            >\r\n              תאריך הפגישה\r\n            </label>\r\n            <input\r\n              onChange={(e) => this.setState({ date: e.target.value })}\r\n              type=\"date\"\r\n              className=\"form-control\"\r\n              id=\"date\"\r\n              placeholder=\"תאריך הפגישה\"\r\n              value={this.state.date}\r\n              required\r\n            />\r\n          </div>\r\n          <div className=\"form-group\">\r\n            <label\r\n              className=\"fLabels\"\r\n              style={{ float: \"right\" }}\r\n              htmlFor=\"hour\"\r\n            >\r\n              שעת הפגישה\r\n            </label>\r\n            <input\r\n              onChange={(e) => this.setState({ time: e.target.value })}\r\n              type=\"time\"\r\n              className=\"form-control\"\r\n              id=\"hour\"\r\n              placeholder=\"שעת הפגישה\"\r\n              value={this.state.time}\r\n              required\r\n            />\r\n          </div>\r\n          <div className=\"form-group\">\r\n            <label\r\n              className=\"fLabels\"\r\n              style={{ float: \"right\" }}\r\n              htmlFor=\"place\"\r\n            >\r\n              מיקום הפגישה\r\n            </label>\r\n            <input\r\n              onChange={(e) => this.setState({ place: e.target.value })}\r\n              type=\"text\"\r\n              className=\"form-control\"\r\n              id=\"place\"\r\n              placeholder=\"מיקום הפגישה\"\r\n              value={this.state.place}\r\n              required\r\n            />\r\n          </div>\r\n          <div className=\"form-group\">\r\n            <label\r\n              className=\"fLabels\"\r\n              style={{ float: \"right\" }}\r\n              htmlFor=\"description\"\r\n            >\r\n              תיאור\r\n            </label>\r\n            <input\r\n              onChange={(e) => this.setState({ description: e.target.value })}\r\n              type=\"text\"\r\n              className=\"form-control\"\r\n              id=\"description\"\r\n              value={this.state.description}\r\n              placeholder=\"תיאור\"\r\n            />\r\n          </div>\r\n          <div className=\"form-group\">\r\n            <input\r\n              type=\"checkbox\"\r\n              className=\"form-check-input w-25\"\r\n              id=\"scheduledMeeting\"\r\n              checked={this.state.scheduled}\r\n              onChange={(e) => this.setState({ scheduled: !this.state.scheduled })}\r\n            />\r\n            <label\r\n              className=\"form-check-label check-meeting-lbl w-75\"\r\n              style={{ float: \"right\" }}\r\n              htmlFor=\"description\"\r\n            >\r\n              פגישות קבועות - לשלושת החודשים הקרובים\r\n            </label>\r\n          </div>\r\n          <br />\r\n          <button\r\n            className=\"btn btn-success setup-meeting-btn\"\r\n            style={{ float: \"right\", marginRight: \"700px\" }}\r\n          >\r\n            קבע פגישה!{\" \"}\r\n          </button>\r\n        </form>\r\n        {this.getTable()}\r\n      </div >\r\n    );\r\n  }\r\n}\r\n\r\nexport default Meeting;\r\n"]},"metadata":{},"sourceType":"module"}